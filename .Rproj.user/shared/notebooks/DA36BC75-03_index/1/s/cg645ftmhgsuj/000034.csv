"0",""
"0",""
"0",""
"0",""
"0",""
"0","#make the table"
"0","index_tab <- index_disp %>%"
"0","  filter(date==2019) %>%"
"0","  select(country, SPI.INDEX,SPI.INDEX.DIM1,SPI.INDEX.DIM2,SPI.INDEX.DIM3,SPI.INDEX.DIM4,SPI.INDEX.DIM5) "
"0",""
"0","#make nice looking"
"0","index_tab <- index_tab %>%"
"0","  flextable() %>%"
"0","  add_header_lines('Overall SPI Index in 2019 and Dimension Scores.') %>%"
"0","  set_header_labels(values=list("
"0","                       country=""Country"", "
"0","                       SPI.INDEX=""SPI Index Value"","
"0","                       SPI.INDEX.DIM1=""Dim 1: Data Use"","
"0","                       SPI.INDEX.DIM2=""Dim 2: Data Services"","
"0","                       SPI.INDEX.DIM3=""Dim 3: Data Products "","
"0","                       SPI.INDEX.DIM4=""Dim 4: Data Sources"","
"0","                       SPI.INDEX.DIM5=""Dim 5: Data Infrastructure"""
"0","                                   )) %>%"
"0","    bg(j = c('SPI.INDEX'), "
"0","       bg = scales::col_quantile(""RdYlGn"", domain=NULL, n=8)) %>%"
"0","    bg(j = c('SPI.INDEX.DIM1'),"
"0","       bg = scales::col_quantile(""RdYlGn"", domain=NULL, n=4)) %>%"
"0","    bg(j = c('SPI.INDEX.DIM2'),"
"0","       bg = scales::col_quantile(""RdYlGn"", domain=NULL, n=8)) %>%"
"0","    bg(j = c('SPI.INDEX.DIM3'),"
"0","       bg = scales::col_quantile(""RdYlGn"", domain=NULL, n=8)) %>%"
"0","    bg(j = c('SPI.INDEX.DIM4'),"
"0","       bg = scales::col_quantile(""RdYlGn"", domain=NULL, n=8)) %>%"
"0","    bg(j = c('SPI.INDEX.DIM5'),"
"0","       bg = scales::col_quantile(""RdYlGn"", domain=NULL, n=4))"
"0",""
"0","  "
"0",""
"0","FitFlextableToPage(index_tab)"
