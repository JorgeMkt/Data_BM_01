"0",""
"0","#Analysis of variance.  In the analysis below, I will calculate the variance in each dimension and in each pillar."
"0",""
"0","anova_pillar_df <- spi_index_df %>%"
"0","  mutate(INDEX.SPI.D1.5=SPI.INDEX.DIM1/100) %>%"
"0","  select(country, iso3c, date, starts_with(""INDEX"")) %>%"
"0","  pivot_longer("
"0","    cols=starts_with(""INDEX""),"
"0","    names_to='Pillar',"
"0","    values_to='value'"
"0","  ) %>%"
"0","  group_by(Pillar, date) %>%"
"0","  nest() %>%"
"0","  mutate("
"0","    std_dev=map("
"0","      data,"
"0","      ~round(sd(.x$value, na.rm=T),2)"
"0","        ),"
"0","    std_dev=as.numeric(std_dev)"
"0","  ) %>%"
"0","  left_join(pillars, by = c('Pillar'='pillar_id'))"
"0","  "
"0","    "
"0","anova_pillar_plot <- anova_pillar_df %>%"
"0","  filter(date==2019) %>%"
"0","  ggplot(aes(x=Pillar, y=std_dev))  +"
"0","  geom_segment( aes(x=Pillar ,xend=Pillar, y=0, yend=std_dev), color=""black"") +"
"0","  geom_point(size=3) +"
"0","  # scale_color_manual(name=""HCI"","
"0","  #                    labels = c(""Over-performers"", ""Under-performers""),"
"0","  #                    values = c('above'=""#1A9850"", 'below'=""#D73027"")) +"
"0","  coord_flip() +"
"0","  theme_bw() +"
"0","  theme("
"0","    panel.grid.minor.y = element_blank(),"
"0","    panel.grid.major.y = element_blank(),"
"0","    legend.position = 'bottom'"
"0","  ) +"
"0","  xlab("""") +"
"0","  ylab(""Standard Deviation"") +"
"0","  ggtitle(""Variation in SPI Pillars"")"
"0",""
"0","anova_pillar_plot  "
"0",""
