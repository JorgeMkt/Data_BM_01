"0",""
"0","gdp_reg_df <- wbstats::wb_data("
"0","  indicator='NY.GDP.PCAP.KD',"
"0","  start_date=2016,"
"0","  end_date=2019"
"0","    ) %>%"
"0","  mutate(log_gdp_pcap=log(NY.GDP.PCAP.KD)) %>%"
"0","  left_join(select(comparison_df,iso3c,date, region,SPI.INDEX,SCI,ODIN_score,SPI_v0)) #merge on SPI Index data"
"0","  "
"0","  "
"0","#regress Log GDP SPI"
"0","m_spi <- lm_robust(SPI.INDEX ~ log_gdp_pcap + factor(date), data = gdp_reg_df, se_type = ""HC2"")"
"0","summary(m_spi)"
"1","
Call:
"
"1",""
"1","lm_robust(formula = SPI.INDEX ~ log_gdp_pcap + factor(date), 
    data = gdp_reg_df, se_type = ""HC2"")"
"1",""
"1","

"
"1","Standard error type: "
"1"," "
"1","HC2"
"1"," "
"1","
"
"1","
Coefficients:
"
"1","                "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1","   Pr(>|t|)"
"1"," CI Lower"
"1"," CI Upper"
"1","  DF"
"1","
(Intercept)     "
"1","  -31.235"
"1","      2.714"
"1"," -11.509"
"1","  6.437e-28"
"1"," -36.5646"
"1","  -25.905"
"1"," 621"
"1","
log_gdp_pcap    "
"1","    9.373"
"1","      0.289"
"1","  32.430"
"1"," 9.703e-136"
"1","   8.8053"
"1","    9.940"
"1"," 621"
"1","
factor(date)2017"
"1","    1.543"
"1","      1.657"
"1","   0.931"
"1","  3.522e-01"
"1","  -1.7119"
"1","    4.798"
"1"," 621"
"1","
factor(date)2018"
"1","    2.812"
"1","      1.612"
"1","   1.744"
"1","  8.160e-02"
"1","  -0.3538"
"1","    5.977"
"1"," 621"
"1","
factor(date)2019"
"1","    2.731"
"1","      1.571"
"1","   1.739"
"1","  8.257e-02"
"1","  -0.3534"
"1","    5.816"
"1"," 621"
"1","
"
"1","
Multiple R-squared: "
"1"," "
"1","0.4873"
"1"," "
"1",",	Adjusted R-squared: "
"1"," "
"1","0.484"
"1"," "
"1","
F-statistic: 264.6 on 4 and 621 DF,  p-value: < 2.2e-16"
"1","
"
"0","#regress Log GDP SCI"
"0","m_sci <- lm_robust(SCI ~ log_gdp_pcap + factor(date), data = gdp_reg_df, se_type = ""HC2"")"
"0","summary(m_sci)"
"1","
Call:
"
"1",""
"1","lm_robust(formula = SCI ~ log_gdp_pcap + factor(date), data = gdp_reg_df, 
    se_type = ""HC2"")"
"1",""
"1","

"
"1","Standard error type: "
"1"," "
"1","HC2"
"1"," "
"1","
"
"1","
Coefficients:
"
"1","                "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1","  Pr(>|t|)"
"1"," CI Lower"
"1"," CI Upper"
"1","  DF"
"1","
(Intercept)     "
"1","   43.809"
"1","     4.6697"
"1","  9.3816"
"1"," 1.622e-19"
"1","   34.637"
"1","   52.982"
"1"," 558"
"1","
log_gdp_pcap    "
"1","    2.956"
"1","     0.5764"
"1","  5.1285"
"1"," 4.034e-07"
"1","    1.824"
"1","    4.088"
"1"," 558"
"1","
factor(date)2017"
"1","   -1.039"
"1","     1.8666"
"1"," -0.5566"
"1"," 5.780e-01"
"1","   -4.705"
"1","    2.627"
"1"," 558"
"1","
factor(date)2018"
"1","   -2.436"
"1","     1.8289"
"1"," -1.3322"
"1"," 1.833e-01"
"1","   -6.029"
"1","    1.156"
"1"," 558"
"1","
factor(date)2019"
"1","   -2.014"
"1","     1.8398"
"1"," -1.0948"
"1"," 2.741e-01"
"1","   -5.628"
"1","    1.599"
"1"," 558"
"1","
"
"1","
Multiple R-squared: "
"1"," "
"1","0.04314"
"1"," "
"1",",	Adjusted R-squared: "
"1"," "
"1","0.03628"
"1"," "
"1","
F-statistic: 7.188 on 4 and 558 DF,  p-value: 1.198e-05"
"1","
"
"0","#regress Log GDP ODIN"
"0","m_odin <- lm_robust(ODIN_score ~ log_gdp_pcap + factor(date), data = gdp_reg_df, se_type = ""HC2"")"
"0","summary(m_odin)"
"1","
Call:
"
"1",""
"1","lm_robust(formula = ODIN_score ~ log_gdp_pcap + factor(date), 
    data = gdp_reg_df, se_type = ""HC2"")"
"1",""
"1","

"
"1","Standard error type: "
"1"," "
"1","HC2"
"1"," "
"1","
"
"1","
Coefficients:
"
"1","                "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1","  Pr(>|t|)"
"1"," CI Lower"
"1"," CI Upper"
"1","  DF"
"1","
(Intercept)     "
"1"," -22.4500"
"1","     2.9943"
"1"," -7.4976"
"1"," 2.044e-13"
"1","  -28.329"
"1","  -16.571"
"1"," 677"
"1","
log_gdp_pcap    "
"1","   7.3424"
"1","     0.3412"
"1"," 21.5207"
"1"," 1.136e-78"
"1","    6.673"
"1","    8.012"
"1"," 677"
"1","
factor(date)2017"
"1","   0.5339"
"1","     1.4265"
"1","  0.3743"
"1"," 7.083e-01"
"1","   -2.267"
"1","    3.335"
"1"," 677"
"1","
factor(date)2018"
"1","   4.6910"
"1","     1.4822"
"1","  3.1649"
"1"," 1.621e-03"
"1","    1.781"
"1","    7.601"
"1"," 677"
"1","
factor(date)2019"
"1","   5.0995"
"1","     1.4679"
"1","  3.4740"
"1"," 5.454e-04"
"1","    2.217"
"1","    7.982"
"1"," 677"
"1","
"
"1","
Multiple R-squared: "
"1"," "
"1","0.3995"
"1"," "
"1",",	Adjusted R-squared: "
"1"," "
"1","0.396"
"1"," "
"1","
F-statistic: 122.6 on 4 and 677 DF,  p-value: < 2.2e-16"
"1","
"
"0","#regress Log GDP SPI_v0"
"0","m_spi_v0 <- lm_robust(SPI_v0 ~ log_gdp_pcap + factor(date), data = gdp_reg_df, se_type = ""HC2"")"
"0","summary(m_spi_v0)"
"1","
Call:
"
"1",""
"1","lm_robust(formula = SPI_v0 ~ log_gdp_pcap + factor(date), data = gdp_reg_df, 
    se_type = ""HC2"")"
"1",""
"1","

"
"1","Standard error type: "
"1"," "
"1","HC2"
"1"," "
"1","
"
"1","
Coefficients:
"
"1","                "
"1"," Estimate"
"1"," Std. Error"
"1","  t value"
"1","  Pr(>|t|)"
"1"," CI Lower"
"1"," CI Upper"
"1","  DF"
"1","
(Intercept)     "
"1"," 22.12733"
"1","     6.0578"
"1","  3.65271"
"1"," 2.930e-04"
"1","  10.2193"
"1","   34.035"
"1"," 412"
"1","
log_gdp_pcap    "
"1","  3.95065"
"1","     0.7739"
"1","  5.10476"
"1"," 5.070e-07"
"1","   2.4293"
"1","    5.472"
"1"," 412"
"1","
factor(date)2017"
"1"," -0.06389"
"1","     1.9002"
"1"," -0.03362"
"1"," 9.732e-01"
"1","  -3.7993"
"1","    3.671"
"1"," 412"
"1","
factor(date)2018"
"1","  4.52621"
"1","     1.9481"
"1","  2.32336"
"1"," 2.065e-02"
"1","   0.6967"
"1","    8.356"
"1"," 412"
"1","
"
"1","
Multiple R-squared: "
"1"," "
"1","0.0761"
"1"," "
"1",",	Adjusted R-squared: "
"1"," "
"1","0.06937"
"1"," "
"1","
F-statistic: 10.75 on 3 and 412 DF,  p-value: 8.122e-07"
"1","
"
"0","gdp_long <- gdp_reg_df %>%"
"0","  pivot_longer("
"0","    cols = c('SPI.INDEX', 'SPI_v0', 'ODIN_score', 'SCI'),"
"0","    names_to='index',"
"0","    values_to='index_values'"
"0","  ) %>%"
"0","  mutate("
"0","    index_name=case_when("
"0","      index=='SPI.INDEX' ~ ""SPI Index"","
"0","      index=='SPI_v0' ~ ""SPI Index Version 0"","
"0","      index=='ODIN_score' ~ ""Open Data Watch"","
"0","      index=='SCI' ~ ""SCI"","
"0","      "
"0","    )"
"0","  ) %>%"
"0","  filter(date==2018)"
"0",""
"0","ggplot(gdp_long, aes(x=log_gdp_pcap,y=index_values, color=region)) +"
"0","  facet_wrap(~index_name) +"
"0","  # geom_point() +"
"0","  geom_text(aes(label=iso3c)) +"
"0","  theme_bw() +"
"0","  labs("
"0","    title='Scatterplot of Statistical Capacity Index (SCI) on SPI Index'"
"0","  ) +"
"0","  xlab('Log GDP Per Capita') +"
"0","  ylab('Index Values') +"
"0","  theme(legend.position = 'bottom')"
"0",""
