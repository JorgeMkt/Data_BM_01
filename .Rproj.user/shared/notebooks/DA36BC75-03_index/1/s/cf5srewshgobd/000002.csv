"0",""
"0",""
"0","#colors"
"0","col_palette <- c(""#1A9850"",  ""#BFCF28"", ""#E7BB25"", ""#DE7B2B"",  ""#D73027"" )"
"0",""
"0","col_palette2 <- c(""#1A9850"",  ""#E7BB25"", ""#D73027"" )"
"0",""
"0","#make the table"
"0","index_tab_recode <- index_compare %>%"
"0","  mutate(SPI.INDEX=round(SPI.INDEX,1),"
"0","         SPI.INDEX.ALT=round(SPI.INDEX.ALT,1),"
"0","         SPI.INDEX.ALT2=round(SPI.INDEX.ALT2,1)) %>%"
"0","  select(country, SPI.INDEX, spi_groups, SPI.INDEX.ALT, spi_alt_groups, SPI.INDEX.ALT2, spi_alt2_groups)"
"0","#make nice looking"
"0","index_tab_recode <- index_tab_recode %>%"
"0","  flextable() %>%"
"0","  add_header_lines('SPI overall scores over time') %>%"
"0","  set_header_labels(values=list("
"0","                       country=""Country"", "
"0","                       SPI.INDEX=""SPI Overall Score"","
"0","                       spi_groups=""SPI Maturity Grouping"","
"0","                       SPI.INDEX.ALT=""SPI Overall Score: Top Coding OECD High Income Countries for Dimension 3."","
"0","                       spi_alt_groups=""SPI Maturity Grouping: Top Coding OECD High Income"","
"0","                       SPI.INDEX.ALT2=""SPI Overall Score: Top Coding All High Income Countries for Dimension 3."","
"0","                       spi_alt2_groups=""SPI Maturity Grouping: Top Coding All High Income"""
"0","                                   )) %>%"
"0","    bg(j = c('SPI.INDEX'), "
"0","       bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE)) %>%"
"0","    bg(j = c('spi_groups'),"
"0","       bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE), source = 'SPI.INDEX') %>%"
"0","    bg(j = c('SPI.INDEX.ALT'), "
"0","       bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE)) %>%"
"0","    bg(j = c('spi_alt_groups'),"
"0","       bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE), source = 'SPI.INDEX.ALT') %>%"
"0","    bg(j = c('SPI.INDEX.ALT2'), "
"0","       bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE)) %>%"
"0","    bg(j = c('spi_alt2_groups'),"
"0","       bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE), source = 'SPI.INDEX.ALT2')   "
"0",""
"0","FitFlextableToPage(index_tab_recode)"
