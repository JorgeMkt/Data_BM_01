"0",""
"0","#get top 10 and bottom 10 over performers compared to gdp and hci"
"0",""
"0","## GDP"
"0","#regress SPI on gdp"
"0","m_spi <- lm(SPI.INDEX ~ log(value) , data = gdp_df_2019) "
"0",""
"0","gdp_overperformers_df <- gdp_df_2019 %>%"
"0","  modelr::add_residuals(m_spi) %>%"
"0","  arrange(-resid) %>%"
"0","  head(15)"
"0",""
"0","gdp_underperformers_df <- gdp_df_2019 %>%"
"0","  modelr::add_residuals(m_spi) %>%"
"0","  arrange(resid) %>%"
"0","  head(15)"
"0",""
"0",""
"0","gdp_overperformers_plot <-  gdp_overperformers_df %>%"
"0","  bind_rows(gdp_underperformers_df) %>%"
"0","  arrange(resid) %>%"
"0","  mutate(country=factor(country, levels=country),"
"0","         group=if_else(resid>=0, 'above','below')) %>%"
"0","  ggplot(aes(x=country, y=resid, color=group)) +"
"0","  geom_segment( aes(x=country ,xend=country, y=0, yend=resid), color=""black"") +"
"0","  geom_point(size=3) +"
"0","  scale_color_manual(name=""GDP per Capita"","
"0","                     labels = c(""Over-performers"", ""Under-performers""),"
"0","                     values = c('above'=""#1A9850"", 'below'=""#D73027"")) +"
"0","  coord_flip() +"
"0","  theme_bw() +"
"0","  theme("
"0","    panel.grid.minor.y = element_blank(),"
"0","    panel.grid.major.y = element_blank(),"
"0","    legend.position = 'bottom'"
"0","  ) +"
"0","  xlab("""") +"
"0","  ylab(""SPI (deviation)"") +"
"0","  ggtitle(""GDP per capita"")"
"0",""
"0",""
"0",""
"0","### HCI"
"0",""
"0",""
"0","#regress SPI on hci"
"0","m_spi_hci <- lm(SPI.INDEX ~ value , data = hci_df_2018) "
"0",""
"0","hci_overperformers_df <- hci_df_2018 %>%"
"0","  modelr::add_residuals(m_spi_hci) %>%"
"0","  arrange(-resid) %>%"
"0","  head(15)"
"0",""
"0","hci_underperformers_df <- hci_df_2018 %>%"
"0","  modelr::add_residuals(m_spi_hci) %>%"
"0","  arrange(resid) %>%"
"0","  head(15)"
"0",""
"0","hci_overperformers_plot <-  hci_overperformers_df %>%"
"0","  bind_rows(hci_underperformers_df) %>%"
"0","  arrange(resid) %>%"
"0","  mutate(country=factor(country, levels=country),"
"0","         group=if_else(resid>=0, 'above','below')) %>%"
"0","  ggplot(aes(x=country, y=resid, color=group)) +"
"0","  geom_segment( aes(x=country ,xend=country, y=0, yend=resid), color=""black"") +"
"0","  geom_point(size=3) +"
"0","  scale_color_manual(name=""HCI"","
"0","                     labels = c(""Over-performers"", ""Under-performers""),"
"0","                     values = c('above'=""#1A9850"", 'below'=""#D73027"")) +"
"0","  coord_flip() +"
"0","  theme_bw() +"
"0","  theme("
"0","    panel.grid.minor.y = element_blank(),"
"0","    panel.grid.major.y = element_blank(),"
"0","    legend.position = 'bottom'"
"0","  ) +"
"0","  xlab("""") +"
"0","  ylab(""SPI (deviation)"") +"
"0","  ggtitle(""Human Capital Index"")"
"0",""
"0",""
"0",""
"0","gdp_overperformers_plot + hci_overperformers_plot +"
"0","  plot_annotation(title='Top 15 Over/Under-Performers on SPI overall score compared to GDP per capita and Human Capital Index',"
"0","                  caption=str_wrap('Over and under performers calculated for GDP per capita by using OLS regression of SPI overall score in 2019 on Log GDP per capita and calculting residuals from this regression.  Over and Under performers for Human Capital Index calculated similarly.',100)"
"0","                  )"
