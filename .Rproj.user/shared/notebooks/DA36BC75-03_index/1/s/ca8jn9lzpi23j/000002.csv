"0",""
"0","#add in population"
"0","pop_df <- wbstats::wb(country=""all"","
"0","             indicator='SP.POP.TOTL',"
"0","             startdate=2004,"
"0","             enddate=2019) %>%"
"0","  mutate(date=as.numeric(date)) %>%"
"0","  mutate(population=value) %>%"
"0","  select(country, date, population) "
"0",""
"0",""
"0","#read in the SPI dataset"
"0","spi_df_final <- read_csv( file = paste(output_dir, 'SPI_data.csv', sep=""/"")) %>%"
"0","  left_join(pop_df) %>%"
"0","  mutate(weights=wgt)  #create a variable for weights for estimates.  This just makes is easier to switch between weights and unweighted estimates."
"0",""
"0",""
"0",""
"0","metadata <- read_csv(paste(raw_dir, '/metadata/SPI_dimensions_sources.csv', sep=""""))"
"0",""
"0","metadata_full <- metadata %>%"
"0","  bind_rows(read_csv(paste(raw_dir, '/metadata/SPI_index_sources.csv', sep="""")))"
"0",""
"0","pillars <- read_csv(paste(raw_dir, '/metadata/SPI_pillars.csv', sep=""""))"
"0",""
