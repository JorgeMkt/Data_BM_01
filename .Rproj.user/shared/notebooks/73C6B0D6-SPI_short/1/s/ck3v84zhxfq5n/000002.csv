"0",""
"0",""
"0","Request_metadata <- GET(url = ""http://api.worldbank.org/v2/country/all/indicator/5.21.01.01.sdds?format=json&date=2004:2015&per_page=5000"")"
"0","Response_metadata <- content(Request_metadata, as = ""text"", encoding = ""UTF-8"")"
"0",""
"0","# Parse the JSON content and convert it to a data frame."
"0","D2.1_DSDR_sci <- jsonlite::fromJSON(Response_metadata, flatten = TRUE) %>%"
"0","  data.frame() %>%"
"0","  transmute("
"0","    iso3c=countryiso3code,"
"0","    country=country.value,"
"0","    date=as.numeric(date),"
"0","    SDDS=value"
"0","  ) %>%"
"0","  left_join(spi_df_empty) %>% #add on country metadata"
"0","  filter(!is.na(income)) %>%"
"0","  select(iso3c, country, date, SDDS  ) "
"2","Joining, by = c(""iso3c"", ""country"", ""date"")
"
"0","#read in metadata file."
"0",""
"0","#pull data for several of the standards from WDI metadata"
"0",""
"0","df <- WDI_metadata"
"0",""
"0","# Manipulate and clean final data"
"0","df <- df %>%"
"0","  filter(!is.na(Income.Group))  #keep just countries (drop aggregations)"
"0",""
"0",""
"0","D2.1_DSDR <- df %>%"
"0","  mutate(iso3c=if_else(is.na(Country.Code), Code, Country.Code),"
"0","         country=Table.Name) %>%"
"0","  select(c('iso3c', 'country', 'date',  'IMF.data.dissemination.standard')  ) %>%"
"0","  mutate(IDDS=IMF.data.dissemination.standard) %>%"
"0","  mutate(SPI.D2.1.GDDS=case_when("
"0","    IDDS==""Special Data Dissemination Standard Plus (SDDS+)"" | IDDS==""Special Data Dissemination Standard (SDDS)""~ 1, "
"0","    IDDS==""Enhanced General Data Dissemination System (e-GDDS)""~ 0.5,"
"0","    TRUE ~ 0 ),"
"0","    SDDS=case_when("
"0","     IDDS==""Special Data Dissemination Standard (SDDS)""~ 1, "
"0","    TRUE ~ 0 ))  %>%"
"0","  bind_rows(D2.1_DSDR_sci) %>%"
"0","  rename(RAW.D2.1.IDDS=IDDS) %>%"
"0","  select(iso3c, country, date, RAW.D2.1.IDDS, SPI.D2.1.GDDS  ) %>%"
"0","  arrange(date, country) "
"0",""
"0",""
"0",""
"0",""
"0",""
"0",""
"0",""
"0",""
"0",""
