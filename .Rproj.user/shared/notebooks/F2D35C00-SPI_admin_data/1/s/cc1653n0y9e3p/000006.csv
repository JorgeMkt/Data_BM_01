"0",""
"0","#read in ILO data"
"0","ILO_df <- readxl::read_excel( path=paste(dir, ""Data/D2. CS/ILO/"","
"0","                                 ""ILOSTAT sources 8may2020.xlsx"","
"0","                                 sep=""""),"
"0","                            .name_repair = 'universal')"
"0",""
"0",""
"0","countries <- read_csv(file=paste(dir, ""Data/D2. CS/ILO/"","
"0","                                 ""ilostat-2020-06-24.csv"","
"0","                                 sep="""")) %>%"
"0","  rename(Country=ref_area.label,"
"0","         iso3c=ref_area) %>%"
"0","  group_by(iso3c, Country) %>%"
"0","  summarise(n=n()) %>%"
"0","  select(-n)"
"0","  "
"0","#filter out surveys and other non-useful sources"
"0","ILO_map <- ILO_df %>%"
"0","  filter(Source.type %in% c(""Insurance records"","
"0","                            ""Labour inspectorate records"","
"0","                            ""Records of employers' organizations"","
"0","                            ""Other administrative records and related sources"","
"0","                            ""Employment office records"","
"0","                            ""Records of workers' organizations"")) %>%"
"0","  mutate(date=as.numeric(str_sub( Latest.period.available,1,4))) %>%"
"0","  left_join(countries) %>%"
"0","  write_excel_csv(paste(dir, ""Data/D2. CS/ILO/"","
"0","                                 ""ILOSTAT_sources.csv"","
"0","                                 sep="""")) %>%"
"0","  group_by(iso3c, date, Source.type) %>%"
"0","  summarise(Source.type=Source.type[which(!is.na(Source.type))[1]]) "
"0",""
"0",""
"0","ilo_mapper <- function(indicator,title_text) {"
"0","  "
"0","  indicator<-enquo(indicator)"
"0",""
"0","  ilo_map <- ILO_map %>%"
"0","    #filter(Source.type==!! indicator) %>%"
"0","    right_join(country_metadata) %>%"
"0","    mutate(available=!is.na(Source.type))"
"0","  "
"0","  "
"0","  "
"0","   ggplot() +"
"0","    geom_map(data = ilo_map, aes(map_id = iso3c, fill = available), map = maps$countries) + "
"0","    geom_polygon(data = maps$disputed, aes(long, lat, group = group, map_id = id), fill = ""grey80"") + "
"0","    geom_polygon(data = maps$lakes, aes(long, lat, group = group), fill = ""white"")  +"
"0","     geom_path(data = maps$boundaries,"
"0","               aes(long, lat, group = group),"
"0","               color = ""white"","
"0","               size = 0.1,"
"0","               lineend = maps$boundaries$lineend,"
"0","              linetype = maps$boundaries$linetype) +"
"0","    scale_x_continuous(expand = c(0, 0), limits = standard_crop_wintri()$xlim) +"
"0","    scale_y_continuous(expand = c(0, 0), limits = standard_crop_wintri()$ylim) +"
"0","    scale_fill_brewer("
"0","      name='Available',"
"0","      palette='Paired',"
"0","      na.value='red'"
"0","    ) +"
"0","    coord_equal() +"
"0","    theme_map(base_size=12) +"
"0","    labs("
"0","      title=str_wrap(title_text,100),"
"0","      caption = 'Source: ILO'"
"0","    )"
"0",""
"0",""
"0","}"
"0",""
"0","ilo_mapper('Admin', 'Labor Administrative Records Available and Used in ILOSTATS for Country According to ILO Database')"
"0",""
