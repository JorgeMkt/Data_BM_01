"0",""
"0","# load data"
"0",""
"0","ASPIRE_df <- read_dta(paste(dir, ""/Data/D2. CS/ASPIRE Admin data/ASPIRE Admin data/ASPIRE_Global_SSN.dta"", sep=""""))"
"0",""
"0","#aggregate to unique countries with beneficiary or expenditure data"
"0","ASPIRE_long <- ASPIRE_df %>%"
"0","  pivot_longer(cols=c(starts_with('ben_'), starts_with('pop_'), starts_with('exp_'),starts_with('gdp')),"
"0","               names_to = c("".value"", ""group""),"
"0","               names_sep=""_20"") %>%"
"0","  mutate(year=2000+as.numeric(group))"
"0","  "
"0",""
"0",""
"0","#Now map the result"
"0","quality = ""high"""
"0","maps <- wbgmaps::wbgmaps[[quality]]"
"0",""
"0",""
"0",""
"0",""
"0",""
"0",""
"0",""
"0",""
"0","  "
"0","  ASPIRE_map <- ASPIRE_long %>%"
"0","    filter(year==2018) %>%"
"0","    group_by( ccode) %>%"
"0","    summarise(ben_count=mean(ben, na.rm=T),"
"0","              ben_exp=mean(exp_b, na.rm=T)) %>%"
"0","    rename(iso3c=ccode) %>%"
"0","    right_join(country_metadata) %>%"
"0","    mutate(ben_info=(!is.na(ben_count) | !is.na(ben_exp))"
"0","           ) "
"0","  "
"0","  "
"0","  "
"0","   ggplot() +"
"0","    geom_map(data = ASPIRE_map, aes(map_id = iso3c, fill = ben_info), map = maps$countries) + "
"0","    geom_polygon(data = maps$disputed, aes(long, lat, group = group, map_id = id), fill = ""grey80"") + "
"0","    geom_polygon(data = maps$lakes, aes(long, lat, group = group), fill = ""white"")  +"
"0","     geom_path(data = maps$boundaries,"
"0","               aes(long, lat, group = group),"
"0","               color = ""white"","
"0","               size = 0.1,"
"0","               lineend = maps$boundaries$lineend,"
"0","              linetype = maps$boundaries$linetype) +"
"0","    scale_x_continuous(expand = c(0, 0), limits = standard_crop_wintri()$xlim) +"
"0","    scale_y_continuous(expand = c(0, 0), limits = standard_crop_wintri()$ylim) +"
"0","    scale_fill_brewer("
"0","      name='Admin Data Available',"
"0","      palette='Paired',"
"0","      na.value='blue'"
"0","    ) +"
"0","    coord_equal() +"
"0","    theme_map(base_size=12) +"
"0","    labs("
"0","      title=str_wrap('Administrative Data Available on Beneficiary Counts or Expenditures in 2018 using ASPIRE',100),"
"0","      caption = 'Source: World Bank. ASPIRE'"
"0","    )"
