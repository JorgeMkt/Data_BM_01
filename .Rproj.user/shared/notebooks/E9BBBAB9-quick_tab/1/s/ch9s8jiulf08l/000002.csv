"0"," "
"0","  "
"0","old_tab <- read_csv(""C:/Users/wb469649/OneDrive - WBG/DECIS/SPI_AKI/Statistical Performance Indicators.csv"") %>%"
"0","  transmute(country=Country,"
"0","         SPI.INDEX.OLD='SPI Index Value',"
"0","         SPI.INDEX.DIM3.OLD='Dim 3: Data Products'"
"0","         )"
"2","Parsed with column specification:
cols(
  Country = [31mcol_character()[39m,
  `SPI Index Value` = [32mcol_double()[39m,
  `Dim 1: Data Use` = [32mcol_double()[39m,
  `Dim 2: Data Services` = [32mcol_double()[39m,
  `Dim 3: Data Products` = [32mcol_double()[39m,
  `Dim 4: Data Sources` = [32mcol_double()[39m,
  `Dim 5: Data Infrastructure` = [32mcol_double()[39m
)
"
"0","#make the table"
"0","index_tab <- index_disp %>%"
"0","  filter(date==2019) %>%"
"0","  left_join(old_tab) %>%"
"0","  select(country, SPI.INDEX,SPI.INDEX.OLD,SPI.INDEX.DIM1,SPI.INDEX.DIM2,SPI.INDEX.DIM3,SPI.INDEX.DIM3.OLD,SPI.INDEX.DIM4,SPI.INDEX.DIM5) "
"2","Joining, by = ""country""
"
"0","#make nice looking"
"0","index_tab <- index_tab %>%"
"0","  flextable() %>%"
"0","  add_header_lines('SPI overall score in 2019 and Dimension Scores.') %>%"
"0","  set_header_labels(values=list("
"0","    country=""Country"", "
"0","    SPI.INDEX=""SPI overall score"","
"0","    SPI.INDEX.OLD=""SPI overall score: Old Scoring"","
"0","    SPI.INDEX.DIM1=""Dim 1: Data Use"","
"0","    SPI.INDEX.DIM2=""Dim 2: Data Services"","
"0","    SPI.INDEX.DIM3=""Dim 3: Data Products "","
"0","    SPI.INDEX.DIM3.OLD=""Old Dim 3: Data Products: No OECD"","
"0","    SPI.INDEX.DIM4=""Dim 4: Data Sources"","
"0","    SPI.INDEX.DIM5=""Dim 5: Data Infrastructure"""
"0","  )) %>%"
"0","  bg(j = c('SPI.INDEX'), "
"0","     bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE)) %>%"
"0","  bg(j = c('SPI.INDEX.DIM1'),"
"0","     bg = scales::col_quantile(col_palette2, domain=NULL, n=3, reverse=TRUE)) %>%"
"0","  bg(j = c('SPI.INDEX.DIM2'),"
"0","     bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE)) %>%"
"0","  bg(j = c('SPI.INDEX.DIM3'),"
"0","     bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE)) %>%"
"0","  bg(j = c('SPI.INDEX.DIM4'),"
"0","     bg = scales::col_quantile(col_palette, domain=NULL, n=5, reverse=TRUE)) %>%"
"0","  bg(j = c('SPI.INDEX.DIM5'),"
"0","     bg = scales::col_quantile(col_palette2, domain=NULL, n=3, reverse=TRUE))"
"0",""
"0",""
"0",""
"0","FitFlextableToPage(index_tab)"
