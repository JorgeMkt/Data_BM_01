"0",""
"0","Request_metadata <- GET(url = ""http://api.worldbank.org/v2/country/all/indicator/3.11.01.03.popreg?format=json&date=2004:2019&per_page=5000"")"
"0","Response_metadata <- content(Request_metadata, as = ""text"", encoding = ""UTF-8"")"
"0",""
"0","# Parse the JSON content and convert it to a data frame."
"0","crvs_df <- jsonlite::fromJSON(Response_metadata, flatten = TRUE) %>%"
"0","  data.frame() %>%"
"0","  transmute("
"0","    iso3c=countryiso3code,"
"0","    country=country.value,"
"0","    date=as.numeric(date),"
"0","    crvs=value"
"0","  ) %>%"
"0","  mutate(SPI.D4.2.3.CRVS=crvs,"
"0","         RAW.D4.2.3.CRVS=crvs) %>%"
"0","  left_join(spi_df_empty) #add on country metadata"
"0",""
"0",""
"0","# Manipulate and clean final data"
"0","crvs_df <- crvs_df %>%"
"0","  filter(!is.na(income)) %>% #keep just countries (drop aggregations)"
"0","  select(c('iso3c', 'country', 'date', 'RAW.D4.2.3.CRVS', 'SPI.D4.2.3.CRVS')  )"
"0",""
"0","#add to spi databases"
"0","spi_df <- spi_df %>%"
"0","  left_join(crvs_df)"
"0",""
"0",""
"0","crvs_map <- crvs_df %>%"
"0","  filter(!is.na(RAW.D4.2.3.CRVS))"
"0",""
"0","spi_mapper('crvs_map', 'RAW.D4.2.3.CRVS', 'Complete Civil Registration & Vital Statistics Data Available According to WDI' )"
