"0",""
"0","#pull data for population and agriculture census from WDI metadata"
"0",""
"0","df <- WDI_metadata"
"0",""
"0","# Manipulate and clean final data"
"0","df <- df %>%"
"0","  filter(!is.na(Income.Group))  #keep just countries (drop aggregations)"
"0","  "
"0",""
"0","pop_census_df <- df %>%"
"0","  mutate(iso3c=if_else(is.na(Country.Code), Code, Country.Code),"
"0","         country=Table.Name) %>%"
"0","  select(c('iso3c', 'country', 'date',  'Latest.population.census')  ) %>%"
"0","  mutate(last_val=str_extract(Latest.population.census, ""\\d{4}"") )%>%"
"0","    mutate(last_val=as.numeric(last_val)) %>%"
"0","    mutate(indicator=case_when("
"0","      (date-last_val<=10) & (date-last_val>0) ~ 1,"
"0","      (date-last_val<=20) & (date-last_val>0) ~ 0.5,"
"0","      TRUE ~ 0 )"
"0","    )  %>%"
"0","    ungroup() %>%"
"0","    select(c('iso3c', 'country', 'date', 'Latest.population.census', 'indicator')  ) %>%"
"0","    arrange(date, country)"
"0","  "
"0","ag_census_df <- df %>%"
"0","  mutate(iso3c=if_else(is.na(Country.Code), Code, Country.Code),"
"0","         country=Table.Name) %>%"
"0","  select(c('iso3c', 'country', 'date',  'Latest.agricultural.census')  ) %>%"
"0","  mutate(last_val=str_extract(Latest.agricultural.census, ""\\d{4}"") )%>%"
"0","    mutate(last_val=as.numeric(last_val)) %>%"
"0","    mutate(indicator=case_when("
"0","      (date-last_val<=10) & (date-last_val>0) ~ 1,"
"0","      (date-last_val<=20) & (date-last_val>0) ~ 0.5,"
"0","      TRUE ~ 0 )"
"0","    )  %>%"
"0","    ungroup() %>%"
"0","    select(c('iso3c', 'country', 'date', 'Latest.agricultural.census', 'indicator')  ) %>%"
"0","    arrange(date, country)"
"0","  "
"0","    "
"0",""
"0",""
