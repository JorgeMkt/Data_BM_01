"0",""
"0",""
"0","Request_metadata <- GET(url = ""http://api.worldbank.org/v2/country/all/indicator/5.21.01.01.sdds?format=json&date=2004:2015&per_page=5000"")"
"0","Response_metadata <- content(Request_metadata, as = ""text"", encoding = ""UTF-8"")"
"0",""
"0","# Parse the JSON content and convert it to a data frame."
"0","D2.2_DSDR_sci <- jsonlite::fromJSON(Response_metadata, flatten = TRUE) %>%"
"0","  data.frame() %>%"
"0","  transmute("
"0","    iso3c=countryiso3code,"
"0","    country=country.value,"
"0","    date=as.numeric(date),"
"0","    SDDS=value"
"0","  ) %>%"
"0","  left_join(spi_df_empty) %>% #add on country metadata"
"0","  filter(!is.na(income)) %>%"
"0","  select(iso3c, country, date, SDDS  ) "
"0",""
"0",""
"0",""
"0","#read in csv file."
"0","D2.2_DSDR <- read_csv(file = paste(raw_dir, '/2.1_DSDR/', ""D2.1.GDDS.csv"", sep="""" )) %>%"
"0","  mutate(D2.1.GDDS=case_when("
"0","    IDDS==""SDDS Plus"" | IDDS==""SDDS""~ 1, "
"0","    IDDS==""e-GDDS""~ 0.5,"
"0","    TRUE ~ 0 ),"
"0","    SDDS=case_when("
"0","     IDDS==""SDDS""~ 1, "
"0","    TRUE ~ 0 ))  %>%"
"0","  bind_rows(D2.2_DSDR_sci) %>%"
"0","  select(iso3c, country, date, IDDS,SDDS, D2.1.GDDS  ) %>%"
"0","  arrange(date, country)"
"0",""
"0",""
"0","D2.2_DSDR_map <- D2.2_DSDR %>%"
"0","  filter(SDDS>0)"
"0",""
"0","spi_mapper('D2.2_DSDR_map', 'SDDS', 'SDDS Data Standards in Place' )"
