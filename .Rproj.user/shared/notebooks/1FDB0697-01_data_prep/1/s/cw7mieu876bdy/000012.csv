"0",""
"0","  #read in ODIN data"
"0","  for (i in 2015:2018) {"
"0","   temp <- read_csv(paste(raw_dir, '/2.2_DSOA/','ODIN_',i,'.csv', sep=""""))  %>%"
"0","        as_tibble(.name_repair = 'universal') %>%"
"0","        mutate(date=i) %>%"
"0","        filter(Data.categories=='All Categories')"
"0",""
"0",""
"0","    assign(paste('geo_df',i,sep=""_""), temp)"
"0","  }"
"0",""
"0","#bind different years together"
"0","geo_df <- bind_rows(geo_df_2015, geo_df_2016, geo_df_2017, geo_df_2018)"
"0",""
"0",""
"0","#create geo scores"
"0","geo_df <- geo_df %>%"
"0","    select(Country.Code, date, First.administrative.level, Second.administrative.level) %>%"
"0","    rename(iso3c=Country.Code) %>%"
"0","    group_by( iso3c) %>%"
"0","    right_join(country_metadata) %>%"
"0","    mutate(First.administrative.level=if_else(is.na(First.administrative.level), 0, First.administrative.level),"
"0","           Second.administrative.level=if_else(is.na(Second.administrative.level), 0, Second.administrative.level))    "
"0","  "
"0",""
"0","#add to spi df"
"0","spi_df <- spi_df %>%"
"0","  left_join(geo_df)"
"0",""
"0","#do the plots  "
"0","   ggplot() +"
"0","    geom_map(data = filter(geo_df, date==2018), aes(map_id = iso3c, fill = First.administrative.level), map = maps$countries) + "
"0","    geom_polygon(data = maps$disputed, aes(long, lat, group = group, map_id = id), fill = ""grey80"") + "
"0","    geom_polygon(data = maps$lakes, aes(long, lat, group = group), fill = ""white"")  +"
"0","     geom_path(data = maps$boundaries,"
"0","               aes(long, lat, group = group),"
"0","               color = ""white"","
"0","               size = 0.1,"
"0","               lineend = maps$boundaries$lineend,"
"0","              linetype = maps$boundaries$linetype) +"
"0","    scale_x_continuous(expand = c(0, 0), limits = standard_crop_wintri()$xlim) +"
"0","    scale_y_continuous(expand = c(0, 0), limits = standard_crop_wintri()$ylim) +"
"0","    scale_fill_distiller("
"0","      name='Data Available',"
"0","      palette='Blues',"
"0","      na.value='black',"
"0","      direction = 1"
"0","    )  +"
"0","    coord_equal() +"
"0","    theme_map(base_size=12) +"
"0","    labs("
"0","      title=str_wrap('Data Availability at First Administrative Unit Level',100),"
"0","      caption = 'Source: ODIN'"
"0","    )"
