"0",""
"0","#read data"
"0","aspire_df_raw <- read_csv(paste(raw_dir, '4.2_SOAD','ASPIRE_sources.csv', sep=""/""))"
"0",""
"0","#cleaning of aspire data"
"0","aspire_df <- aspire_df_raw %>%"
"0","    mutate(date=as.numeric(year)) %>%"
"0","    group_by( ccode, date) %>%"
"0","    summarise(ben_count=mean(ben, na.rm=T),"
"0","              ben_exp=mean(exp_b, na.rm=T)) %>%"
"0","    rename(iso3c=ccode) %>%"
"0","    left_join(country_metadata) %>%"
"0","    mutate(ben_info=(!is.na(ben_count) | !is.na(ben_exp))"
"0","           )"
"0",""
"0",""
"0","#apply carryforward to fill in missing values"
"0","aspire_df <- aspire_df %>%"
"0","  group_by(iso3c) %>%"
"0","  mutate(ben_info_filled=if_else(ben_info==TRUE,as.numeric(ben_info), as.numeric(NA))) %>%"
"0","  fill(ben_info_filled, .direction='down') %>%"
"0","  mutate(SPI.D4.2.1.SPL=if_else(is.na(ben_info_filled),0, ben_info_filled),"
"0","         RAW.D4.2.1.SPL=ben_info) %>%"
"0","  select(c('iso3c', 'country', 'date', 'RAW.D4.2.1.SPL', 'SPI.D4.2.1.SPL')  )"
"0",""
"0","#add to spi databases"
"0","spi_df <- spi_df %>%"
"0","  left_join(aspire_df)"
"0",""
"0","aspire_map <- aspire_df"
"0",""
"0","spi_mapper('aspire_map', 'SPI.D4.2.1.SPL', 'Administrative Data Available on Beneficiary Counts or Expenditures using ASPIRE' )"
