"0",""
"0","#pull SCI values"
"0",""
"0","Request_metadata <- GET(url = ""http://api.worldbank.org/v2/country/all/indicator/IQ.SCI.OVRL?format=json&date=2004:2019&per_page=5000"")"
"0","Response_metadata <- content(Request_metadata, as = ""text"", encoding = ""UTF-8"")"
"0",""
"0","# Parse the JSON content and convert it to a data frame."
"0","sci_df <- jsonlite::fromJSON(Response_metadata, flatten = TRUE) %>%"
"0","  data.frame() %>%"
"0","  transmute("
"0","    iso3c=countryiso3code,"
"0","    country=country.value,"
"0","    date=as.numeric(date),"
"0","    SCI=value"
"0","  ) %>%"
"0","  left_join(spi_df_empty) %>% #add on country metadata"
"0","  filter(!is.na(income)) %>%"
"0","  select(iso3c, country, date, SCI  ) %>%"
"0","  group_by(date) %>%"
"0","  arrange(-SCI) %>%"
"0","  mutate(SCI_rank=rank(-SCI),"
"0","         SCI_rank=if_else(is.na(SCI),as.numeric(NA),SCI_rank))"
"2","Joining, by = c(""iso3c"", ""country"", ""date"")
"
