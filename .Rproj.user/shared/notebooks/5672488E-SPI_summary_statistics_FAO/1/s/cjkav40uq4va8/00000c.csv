"0",""
"0","#add in population"
"0","pop_df <- wbstats::wb(country=""all"","
"0","             indicator='SP.POP.TOTL',"
"0","             startdate=2004,"
"0","             enddate=2019) %>%"
"0","  mutate(date=as.numeric(date)) %>%"
"0","  mutate(population=value) %>%"
"0","  select(country, date, population) "
"0",""
"0","#import data"
"0","SPI <- read_csv(paste(output_dir, 'SPI_index.csv', sep=""/"")) %>%"
"0","    left_join(pop_df) %>%"
"0","  mutate(weights=wgt)  #create a variable for weights for estimates.  This just makes is easier to switch between weights and unweighted estimates."
"2","Parsed with column specification:
cols(
  .default = col_double(),
  country = [31mcol_character()[39m,
  iso3c = [31mcol_character()[39m,
  income = [31mcol_character()[39m,
  region = [31mcol_character()[39m
)
"
"2","See spec(...) for full column specifications.
"
"2","Joining, by = c(""country"", ""date"")
"
"0","#metadata "
"0","metadata <- data.frame("
"0","  series = c('SPI.INDEX', 'SPI.INDEX.DIM1', 'SPI.INDEX.DIM2', 'SPI.INDEX.DIM3', 'SPI.INDEX.DIM4', 'SPI.INDEX.DIM5'),"
"0","  indicator_name = c('SPI Overall Score', 'Dimension 1: Data Use', 'Dimension 2: Data Services', 'Dimension 3: Data Products', 'Dimension 4: Data Sources', 'Dimension 5: Data Infrastructure')"
"0",")"
"0",""
"0","#get list of country info"
"0","country_list <- wbstats::wbcountries()"
"0",""
"0",""
"0","SPI_2019 <- SPI %>%"
"0","  filter(date==2019) %>%"
"0","  filter(!is.na(SPI.INDEX) & !is.na(weights)) %>%"
"0","  mutate(ISO_A3_EH=iso3c) %>%"
"0","  mutate(across(contains(""SPI""),~100*.))"
"0",""
"0","#read in TopoJSON from World Bank"
"0","#countries <- geojsonio::geojson_read(""WB_countries_Admin0_lowres.geojson"","
"0","#                                     what = ""sp"")"
"0",""
