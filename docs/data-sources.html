<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Data Sources | Technical Documentation on Data Sources and Methods for Statistical Performance Indicators</title>
  <meta name="description" content="6 Data Sources | Technical Documentation on Data Sources and Methods for Statistical Performance Indicators" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Data Sources | Technical Documentation on Data Sources and Methods for Statistical Performance Indicators" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Data Sources | Technical Documentation on Data Sources and Methods for Statistical Performance Indicators" />
  
  
  

<meta name="author" content="Brian Stacy" />


<meta name="date" content="2021-01-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="scoring.html"/>
<link rel="next" href="data-infrastructure.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-use.html"><a href="data-use.html"><i class="fa fa-check"></i><b>2</b> Data Use</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-use.html"><a href="data-use.html#indicator-1.1-data-use-by-national-legislature"><i class="fa fa-check"></i><b>2.1</b> Indicator 1.1: Data use by national legislature</a></li>
<li class="chapter" data-level="2.2" data-path="data-use.html"><a href="data-use.html#indicator-1.2-data-use-by-national-executive-branch"><i class="fa fa-check"></i><b>2.2</b> Indicator 1.2: Data use by national executive branch</a></li>
<li class="chapter" data-level="2.3" data-path="data-use.html"><a href="data-use.html#indicator-1.3-data-use-by-civil-society"><i class="fa fa-check"></i><b>2.3</b> Indicator 1.3: Data use by civil society</a></li>
<li class="chapter" data-level="2.4" data-path="data-use.html"><a href="data-use.html#indicator-1.4-data-use-by-academia"><i class="fa fa-check"></i><b>2.4</b> Indicator 1.4: Data use by academia</a></li>
<li class="chapter" data-level="2.5" data-path="data-use.html"><a href="data-use.html#indicator-1.5-data-use-by-international-organizations"><i class="fa fa-check"></i><b>2.5</b> Indicator 1.5: Data use by international organizations</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-use.html"><a href="data-use.html#poverty-comparability"><i class="fa fa-check"></i><b>2.5.1</b> Poverty Comparability</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-use.html"><a href="data-use.html#mortality-rate-under-5-per-1000-live-births"><i class="fa fa-check"></i><b>2.5.2</b> Mortality rate, under-5 (per 1,000 live births)</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-use.html"><a href="data-use.html#debt-service-ppg-and-imf-only-of-exports-of-goods-services-and-primary-income"><i class="fa fa-check"></i><b>2.5.3</b> Debt service (PPG and IMF only, % of exports of goods, services and primary income)</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-use.html"><a href="data-use.html#safely-managed-water"><i class="fa fa-check"></i><b>2.5.4</b> Safely Managed Water</a></li>
<li class="chapter" data-level="2.5.5" data-path="data-use.html"><a href="data-use.html#labor-force-statistics"><i class="fa fa-check"></i><b>2.5.5</b> Labor Force Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-services.html"><a href="data-services.html"><i class="fa fa-check"></i><b>3</b> Data Services</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-services.html"><a href="data-services.html#indicator-2.1-data-releases"><i class="fa fa-check"></i><b>3.1</b> Indicator 2.1: Data Releases</a></li>
<li class="chapter" data-level="3.2" data-path="data-services.html"><a href="data-services.html#indicator-2.2-online-access"><i class="fa fa-check"></i><b>3.2</b> Indicator 2.2: Online access</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-services.html"><a href="data-services.html#source"><i class="fa fa-check"></i><b>3.2.1</b> Source</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-services.html"><a href="data-services.html#indicator-2.3-advisory-analytical-services"><i class="fa fa-check"></i><b>3.3</b> Indicator 2.3: Advisory/ Analytical Services</a></li>
<li class="chapter" data-level="3.4" data-path="data-services.html"><a href="data-services.html#indicator-2.4-data-services"><i class="fa fa-check"></i><b>3.4</b> Indicator 2.4: Data services</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-products.html"><a href="data-products.html"><i class="fa fa-check"></i><b>4</b> Data Products</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-products.html"><a href="data-products.html#indicators-3.1-3.4"><i class="fa fa-check"></i><b>4.1</b> Indicators 3.1-3.4</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="scoring.html"><a href="scoring.html"><i class="fa fa-check"></i><b>5</b> Scoring</a></li>
<li class="chapter" data-level="6" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>6</b> Data Sources</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-sources.html"><a href="data-sources.html#indicator-4.1-censuses-and-surveys"><i class="fa fa-check"></i><b>6.1</b> Indicator 4.1: censuses and surveys</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-sources.html"><a href="data-sources.html#scoring-details"><i class="fa fa-check"></i><b>6.1.1</b> Scoring details</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-sources.html"><a href="data-sources.html#indicator-4.2-administrative-data"><i class="fa fa-check"></i><b>6.2</b> Indicator 4.2: administrative data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-sources.html"><a href="data-sources.html#social-protection-admin-data"><i class="fa fa-check"></i><b>6.2.1</b> Social Protection Admin Data</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-sources.html"><a href="data-sources.html#education-admin-data"><i class="fa fa-check"></i><b>6.2.2</b> Education Admin Data</a></li>
<li class="chapter" data-level="6.2.3" data-path="data-sources.html"><a href="data-sources.html#population-health-admin-data"><i class="fa fa-check"></i><b>6.2.3</b> Population &amp; Health Admin Data</a></li>
<li class="chapter" data-level="6.2.4" data-path="data-sources.html"><a href="data-sources.html#labor-admin-data"><i class="fa fa-check"></i><b>6.2.4</b> Labor Admin Data</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-sources.html"><a href="data-sources.html#indicator-4.3-geospatial-data"><i class="fa fa-check"></i><b>6.3</b> Indicator 4.3: geospatial data</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-sources.html"><a href="data-sources.html#source-1"><i class="fa fa-check"></i><b>6.3.1</b> Source</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data-sources.html"><a href="data-sources.html#indicator-4.4-privatecitizen-generated-data"><i class="fa fa-check"></i><b>6.4</b> Indicator 4.4: private/citizen generated data</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-sources.html"><a href="data-sources.html#covid-mobility-data-availability"><i class="fa fa-check"></i><b>6.4.1</b> Covid Mobility Data Availability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-infrastructure.html"><a href="data-infrastructure.html"><i class="fa fa-check"></i><b>7</b> Data Infrastructure</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-infrastructure.html"><a href="data-infrastructure.html#indicator-5.1-legislation-and-governance"><i class="fa fa-check"></i><b>7.1</b> Indicator 5.1: legislation and governance</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="data-infrastructure.html"><a href="data-infrastructure.html#system-of-national-accounts-in-use"><i class="fa fa-check"></i><b>7.1.1</b> 5.2.1 System of National Accounts in use</a></li>
<li class="chapter" data-level="7.1.2" data-path="data-infrastructure.html"><a href="data-infrastructure.html#national-accounts-base-year"><i class="fa fa-check"></i><b>7.1.2</b> 5.2.2 National Accounts base year</a></li>
<li class="chapter" data-level="7.1.3" data-path="data-infrastructure.html"><a href="data-infrastructure.html#classification-of-national-industry"><i class="fa fa-check"></i><b>7.1.3</b> 5.2.3 Classification of national industry</a></li>
<li class="chapter" data-level="7.1.4" data-path="data-infrastructure.html"><a href="data-infrastructure.html#cpi-base-year"><i class="fa fa-check"></i><b>7.1.4</b> 5.2.4 CPI base year</a></li>
<li class="chapter" data-level="7.1.5" data-path="data-infrastructure.html"><a href="data-infrastructure.html#classification-of-household-consumption"><i class="fa fa-check"></i><b>7.1.5</b> 5.2.5 Classification of household consumption</a></li>
<li class="chapter" data-level="7.1.6" data-path="data-infrastructure.html"><a href="data-infrastructure.html#classification-of-status-of-employment"><i class="fa fa-check"></i><b>7.1.6</b> 5.2.6 Classification of status of employment</a></li>
<li class="chapter" data-level="7.1.7" data-path="data-infrastructure.html"><a href="data-infrastructure.html#central-government-accounting-status"><i class="fa fa-check"></i><b>7.1.7</b> 5.2.7 Central government accounting status</a></li>
<li class="chapter" data-level="7.1.8" data-path="data-infrastructure.html"><a href="data-infrastructure.html#compilation-of-government-finance-statistics"><i class="fa fa-check"></i><b>7.1.8</b> 5.2.8 Compilation of government finance statistics</a></li>
<li class="chapter" data-level="7.1.9" data-path="data-infrastructure.html"><a href="data-infrastructure.html#compilation-of-monetary-and-financial-statistics"><i class="fa fa-check"></i><b>7.1.9</b> 5.2.9 Compilation of monetary and financial statistics</a></li>
<li class="chapter" data-level="7.1.10" data-path="data-infrastructure.html"><a href="data-infrastructure.html#business-process"><i class="fa fa-check"></i><b>7.1.10</b> 5.2.10 Business process</a></li>
<li class="chapter" data-level="7.1.11" data-path="data-infrastructure.html"><a href="data-infrastructure.html#create-overall-indicator"><i class="fa fa-check"></i><b>7.1.11</b> Create Overall Indicator</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data-infrastructure.html"><a href="data-infrastructure.html#indicator-5.3-skills"><i class="fa fa-check"></i><b>7.2</b> Indicator 5.3: skills</a></li>
<li class="chapter" data-level="7.3" data-path="data-infrastructure.html"><a href="data-infrastructure.html#indicator-5.4-partnerships"><i class="fa fa-check"></i><b>7.3</b> Indicator 5.4: partnerships</a></li>
<li class="chapter" data-level="7.4" data-path="data-infrastructure.html"><a href="data-infrastructure.html#indicator-5.5-finance"><i class="fa fa-check"></i><b>7.4</b> Indicator 5.5: finance</a></li>
<li class="chapter" data-level="7.5" data-path="data-infrastructure.html"><a href="data-infrastructure.html#final-dataset"><i class="fa fa-check"></i><b>7.5</b> Final Dataset</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Technical Documentation on Data Sources and Methods for Statistical Performance Indicators</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-sources" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Data Sources</h1>
<p>Cleaning for the Data Sources Indicators. Data Sources (4 Indicators):<br />
- 4.1_SOCS - Indicator 4.1: censuses and surveys<br />
- 4.2_SOAD - Indicator 4.2: administrative data<br />
- 4.3_SOGS - Indicator 4.3: geospatial data<br />
- 4.4_SOPC - Indicator 4.4: private/citizen generated data</p>
<div id="indicator-4.1-censuses-and-surveys" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Indicator 4.1: censuses and surveys</h2>
<p>This indicator draws from data collected by the Statistical Performance Indicators team. The following censuses and surveys are considered:</p>
<ul>
<li>Population &amp; Housing census<br />
</li>
<li>Agriculture census<br />
</li>
<li>Business/establishment census<br />
</li>
<li>Household Survey on income/ consumption/ expenditure/ budget/ Integrated Survey<br />
</li>
<li>Agriculture survey<br />
</li>
<li>Labor Force Survey<br />
</li>
<li>Health/Demographic survey<br />
</li>
<li>Business/establishment survey</li>
</ul>
<div id="scoring-details" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Scoring details</h3>
<div id="population-housing-census" class="section level4" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Population &amp; Housing census</h4>
<p>Population censuses collect data on the size, distribution and composition of population and
information on a broad range of social and economic characteristics of the population. It also
provides sampling frames for household and other surveys. Housing censuses provide information
on the supply of housing units, the structural characteristics and facilities, and health and the
development of normal family living conditions. Data obtained as part of the population census,
including data on homeless persons, are often used in the presentation and analysis of the results
of the housing census. It is recommended that population and housing censuses be conducted at least every 10 years.</p>
<p>1 Point. Population census done within last 10 years<br />
0.5 Points. Population census done within last 20 years
0 Points. Otherwise</p>
</div>
<div id="agriculture-census" class="section level4" number="6.1.1.2">
<h4><span class="header-section-number">6.1.1.2</span> Agriculture census</h4>
<p>Agriculture censuses collect information on agricultural activities, such as
size of holding, land tenure, land use, employment and production, and provide
basic structural data and sampling frames for agricultural surveys. Censuses
of agriculture normally involves collecting key structural data by complete
enumeration of all agricultural holdings, in combination with more detailed
structural data using sampling methods. It is recommended that agricultural
censuses be conducted at least every 10 years.</p>
<p>1 Point. census done within last 10 years<br />
0.5 Points. census done within last 20 years<br />
0 Points. Otherwise</p>
</div>
<div id="businessestablishment-census" class="section level4" number="6.1.1.3">
<h4><span class="header-section-number">6.1.1.3</span> Business/establishment census</h4>
<p>Business/establishment censuses provide valuable information on all economic
activities, number of employed and size of establishments in the economy.
Business Register information is establishment-based and includes business
location, organization type (e.g. subsidiary or parent), industry
classification, and operating data (e.g., receipts and employment).</p>
<p>1 Point. census done within last 10 years<br />
0.5 Points. census done within last 20 years<br />
0 Points. Otherwise</p>
</div>
<div id="household-survey-on-incomeconsumptionexpenditurebudgetintegrated-survey" class="section level4" number="6.1.1.4">
<h4><span class="header-section-number">6.1.1.4</span> Household Survey on income/consumption/expenditure/budget/Integrated Survey</h4>
<p>These surveys collect data on household income (including income in kind),
consumption and expenditure. They typically include income, expenditure, and
consumption surveys, household budget surveys, integrated surveys. It is
recommended that surveys on income and expenditure be conducted at least every
3 to 5 years.</p>
<p>1 Point. 3 or more surveys done within past 10 years<br />
0.6 Points. 2 surveys done within past 10 years;<br />
0.3 Points. 1 survey done within past 10 years;<br />
0 Points. None within past 10 years</p>
</div>
<div id="agriculture-survey" class="section level4" number="6.1.1.5">
<h4><span class="header-section-number">6.1.1.5</span> Agriculture survey</h4>
<p>Agricultural surveys refer to surveys of agricultural holdings based on the
sampling frames established by the agricultural census. These are surveys on
agricultural land, production, crops and livestock, aquaculture, labor and
cost, and time use. Some issues, such as gender and food security, are of
interest to most agriculture surveys.</p>
<p>1 Point. 3 or more surveys done within past 10 years<br />
0.6 Points. 2 surveys done within past 10 years;<br />
0.3 Points. 1 survey done within past 10 years;<br />
0 Points. None within past 10 years</p>
</div>
<div id="labor-force-survey" class="section level4" number="6.1.1.6">
<h4><span class="header-section-number">6.1.1.6</span> Labor Force Survey</h4>
<p>Labor force survey is a standard household-based survey of work-related
statistics at the national and sub-national employment or unemployment levels,
rates or trends. The surveys also provide the characteristics of the employed
or unemployed, including labor force status by age or gender, breakdowns
between employees and the self-employed, public versus private sector
employment, multiple job-holding, hiring, job creation, and duration of
unemployment.</p>
<p>1 Point. 3 or more surveys done within past 10 years<br />
0.6 Points. 2 surveys done within past 10 years;<br />
0.3 Points. 1 survey done within past 10 years;<br />
0 Points. None within past 10 years</p>
</div>
<div id="healthdemographic-survey" class="section level4" number="6.1.1.7">
<h4><span class="header-section-number">6.1.1.7</span> Health/Demographic survey</h4>
<p>Health surveys collect information on various aspects of health of
populations, such as health expenditure, access, utilization, and outcomes.
They typically include Demographic and Health Surveys. It is recommended that
health surveys be conducted at least every 3 to 5 years.</p>
<p>1 Point. 3 or more surveys done within past 10 years<br />
0.6 Points. 2 surveys done within past 10 years;<br />
0.3 Points. 1 survey done within past 10 years;<br />
0 Points. None within past 10 years</p>
</div>
<div id="businessestablishment-survey" class="section level4" number="6.1.1.8">
<h4><span class="header-section-number">6.1.1.8</span> Business/establishment survey</h4>
<p>The business/establishment survey provides information on employment, hours,
and earnings of employees from a sample of business establishments including
private and public, entities that are classified based on an establishment’s
principal activity from the business or establishment census. Establishment
surveys include surveys of businesses, farms, and institutions. They may ask
for information about the establishment itself and/or employee characteristics
and demographics.</p>
<p>1 Point. 3 or more surveys done within past 10 years<br />
0.6 Points. 2 surveys done within past 10 years;<br />
0.3 Points. 1 survey done within past 10 years;<br />
0 Points. None within past 10 years</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data-sources.html#cb37-1" aria-hidden="true"></a><span class="co">#pull data for population and agriculture census from WDI metadata</span></span>
<span id="cb37-2"><a href="data-sources.html#cb37-2" aria-hidden="true"></a></span>
<span id="cb37-3"><a href="data-sources.html#cb37-3" aria-hidden="true"></a>df &lt;-<span class="st"> </span>WDI_metadata</span>
<span id="cb37-4"><a href="data-sources.html#cb37-4" aria-hidden="true"></a></span>
<span id="cb37-5"><a href="data-sources.html#cb37-5" aria-hidden="true"></a><span class="co"># Manipulate and clean final data</span></span>
<span id="cb37-6"><a href="data-sources.html#cb37-6" aria-hidden="true"></a>df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></span>
<span id="cb37-7"><a href="data-sources.html#cb37-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Income.Group))  <span class="co">#keep just countries (drop aggregations)</span></span>
<span id="cb37-8"><a href="data-sources.html#cb37-8" aria-hidden="true"></a>  </span>
<span id="cb37-9"><a href="data-sources.html#cb37-9" aria-hidden="true"></a></span>
<span id="cb37-10"><a href="data-sources.html#cb37-10" aria-hidden="true"></a>pop_census_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></span>
<span id="cb37-11"><a href="data-sources.html#cb37-11" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iso3c=</span><span class="kw">if_else</span>(<span class="kw">is.na</span>(Country.Code), Code, Country.Code),</span>
<span id="cb37-12"><a href="data-sources.html#cb37-12" aria-hidden="true"></a>         <span class="dt">country=</span>Table.Name) <span class="op">%&gt;%</span></span>
<span id="cb37-13"><a href="data-sources.html#cb37-13" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&#39;iso3c&#39;</span>, <span class="st">&#39;country&#39;</span>, <span class="st">&#39;date&#39;</span>,  <span class="st">&#39;Latest.population.census&#39;</span>)  ) <span class="op">%&gt;%</span></span>
<span id="cb37-14"><a href="data-sources.html#cb37-14" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">last_val=</span><span class="kw">str_extract</span>(Latest.population.census, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">d{4}&quot;</span>) )<span class="op">%&gt;%</span></span>
<span id="cb37-15"><a href="data-sources.html#cb37-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">last_val=</span><span class="kw">as.numeric</span>(last_val)) <span class="op">%&gt;%</span></span>
<span id="cb37-16"><a href="data-sources.html#cb37-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">indicator=</span><span class="kw">case_when</span>(</span>
<span id="cb37-17"><a href="data-sources.html#cb37-17" aria-hidden="true"></a>      (date<span class="op">-</span>last_val<span class="op">&lt;=</span><span class="dv">10</span>) <span class="op">&amp;</span><span class="st"> </span>(date<span class="op">-</span>last_val<span class="op">&gt;=</span><span class="dv">0</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb37-18"><a href="data-sources.html#cb37-18" aria-hidden="true"></a>      (date<span class="op">-</span>last_val<span class="op">&lt;=</span><span class="dv">20</span>) <span class="op">&amp;</span><span class="st"> </span>(date<span class="op">-</span>last_val<span class="op">&gt;=</span><span class="dv">0</span>) <span class="op">~</span><span class="st"> </span><span class="fl">0.5</span>,</span>
<span id="cb37-19"><a href="data-sources.html#cb37-19" aria-hidden="true"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span> )</span>
<span id="cb37-20"><a href="data-sources.html#cb37-20" aria-hidden="true"></a>    )  <span class="op">%&gt;%</span></span>
<span id="cb37-21"><a href="data-sources.html#cb37-21" aria-hidden="true"></a><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb37-22"><a href="data-sources.html#cb37-22" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&#39;iso3c&#39;</span>, <span class="st">&#39;country&#39;</span>, <span class="st">&#39;date&#39;</span>, <span class="st">&#39;Latest.population.census&#39;</span>, <span class="st">&#39;indicator&#39;</span>)  ) <span class="op">%&gt;%</span></span>
<span id="cb37-23"><a href="data-sources.html#cb37-23" aria-hidden="true"></a><span class="st">    </span><span class="kw">arrange</span>(date, country)</span>
<span id="cb37-24"><a href="data-sources.html#cb37-24" aria-hidden="true"></a>  </span>
<span id="cb37-25"><a href="data-sources.html#cb37-25" aria-hidden="true"></a>ag_census_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></span>
<span id="cb37-26"><a href="data-sources.html#cb37-26" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iso3c=</span><span class="kw">if_else</span>(<span class="kw">is.na</span>(Country.Code), Code, Country.Code),</span>
<span id="cb37-27"><a href="data-sources.html#cb37-27" aria-hidden="true"></a>         <span class="dt">country=</span>Table.Name) <span class="op">%&gt;%</span></span>
<span id="cb37-28"><a href="data-sources.html#cb37-28" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&#39;iso3c&#39;</span>,  <span class="st">&#39;date&#39;</span>,  <span class="st">&#39;Latest.agricultural.census&#39;</span>)  ) <span class="op">%&gt;%</span></span>
<span id="cb37-29"><a href="data-sources.html#cb37-29" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">last_val=</span><span class="kw">str_extract</span>(Latest.agricultural.census, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">d{4}&quot;</span>) )<span class="op">%&gt;%</span></span>
<span id="cb37-30"><a href="data-sources.html#cb37-30" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">last_val=</span><span class="kw">as.numeric</span>(last_val)) <span class="op">%&gt;%</span></span>
<span id="cb37-31"><a href="data-sources.html#cb37-31" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">indicator=</span><span class="kw">case_when</span>(</span>
<span id="cb37-32"><a href="data-sources.html#cb37-32" aria-hidden="true"></a>      (date<span class="op">-</span>last_val<span class="op">&lt;=</span><span class="dv">10</span>) <span class="op">&amp;</span><span class="st"> </span>(date<span class="op">-</span>last_val<span class="op">&gt;=</span><span class="dv">0</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb37-33"><a href="data-sources.html#cb37-33" aria-hidden="true"></a>      (date<span class="op">-</span>last_val<span class="op">&lt;=</span><span class="dv">20</span>) <span class="op">&amp;</span><span class="st"> </span>(date<span class="op">-</span>last_val<span class="op">&gt;=</span><span class="dv">0</span>) <span class="op">~</span><span class="st"> </span><span class="fl">0.5</span>,</span>
<span id="cb37-34"><a href="data-sources.html#cb37-34" aria-hidden="true"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span> )</span>
<span id="cb37-35"><a href="data-sources.html#cb37-35" aria-hidden="true"></a>    )  <span class="op">%&gt;%</span></span>
<span id="cb37-36"><a href="data-sources.html#cb37-36" aria-hidden="true"></a><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb37-37"><a href="data-sources.html#cb37-37" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&#39;iso3c&#39;</span>,  <span class="st">&#39;date&#39;</span>, <span class="st">&#39;Latest.agricultural.census&#39;</span>, <span class="st">&#39;indicator&#39;</span>)  ) <span class="op">%&gt;%</span></span>
<span id="cb37-38"><a href="data-sources.html#cb37-38" aria-hidden="true"></a><span class="st">    </span><span class="kw">arrange</span>(date, iso3c)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="data-sources.html#cb38-1" aria-hidden="true"></a>census_fun  &lt;-<span class="st"> </span><span class="cf">function</span>(data, input_var) {</span>
<span id="cb38-2"><a href="data-sources.html#cb38-2" aria-hidden="true"></a>  </span>
<span id="cb38-3"><a href="data-sources.html#cb38-3" aria-hidden="true"></a>  data &lt;-<span class="st"> </span>data</span>
<span id="cb38-4"><a href="data-sources.html#cb38-4" aria-hidden="true"></a>  input_var &lt;-<span class="st"> </span>input_var</span>
<span id="cb38-5"><a href="data-sources.html#cb38-5" aria-hidden="true"></a></span>
<span id="cb38-6"><a href="data-sources.html#cb38-6" aria-hidden="true"></a>  <span class="co">#read in csv file.</span></span>
<span id="cb38-7"><a href="data-sources.html#cb38-7" aria-hidden="true"></a>  cs_df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/raw/&#39;</span>, data, <span class="st">&quot;_145.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> )) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#bring in data collected for an original set of 145 countries, then an additional 10, then several more high income counries.</span></span>
<span id="cb38-8"><a href="data-sources.html#cb38-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">bind_rows</span>(<span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/raw/&#39;</span>, data, <span class="st">&quot;_10.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> ))) <span class="op">%&gt;%</span></span>
<span id="cb38-9"><a href="data-sources.html#cb38-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">bind_rows</span>(<span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/raw/&#39;</span>, data, <span class="st">&quot;_high.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> ))) <span class="op">%&gt;%</span><span class="st">            </span></span>
<span id="cb38-10"><a href="data-sources.html#cb38-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">write_excel_csv</span>(<span class="dt">path =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/&#39;</span>, data, <span class="st">&quot;_manual.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> )) <span class="op">%&gt;%</span></span>
<span id="cb38-11"><a href="data-sources.html#cb38-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">distinct</span>() <span class="op">%&gt;%</span></span>
<span id="cb38-12"><a href="data-sources.html#cb38-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(iso3c, country) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-13"><a href="data-sources.html#cb38-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">input_var =</span> <span class="op">!!</span><span class="st"> </span>input_var) <span class="op">%&gt;%</span></span>
<span id="cb38-14"><a href="data-sources.html#cb38-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># The next chunk of code will split our string with the years of the census (i.e. &quot;2000, 2010&quot;) in to separate rows.  We will then aggregate up.</span></span>
<span id="cb38-15"><a href="data-sources.html#cb38-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(</span>
<span id="cb38-16"><a href="data-sources.html#cb38-16" aria-hidden="true"></a>      <span class="dt">temp_col =</span> <span class="kw">map</span>(</span>
<span id="cb38-17"><a href="data-sources.html#cb38-17" aria-hidden="true"></a>        data, </span>
<span id="cb38-18"><a href="data-sources.html#cb38-18" aria-hidden="true"></a>        <span class="op">~</span><span class="st"> </span><span class="kw">str_extract_all</span>(.x<span class="op">$</span>input_var, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">d{4}&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-19"><a href="data-sources.html#cb38-19" aria-hidden="true"></a><span class="st">          </span><span class="kw">flatten</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-20"><a href="data-sources.html#cb38-20" aria-hidden="true"></a><span class="st">          </span><span class="kw">map_chr</span>(<span class="op">~</span><span class="kw">return</span>(.x)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-21"><a href="data-sources.html#cb38-21" aria-hidden="true"></a><span class="st">          </span><span class="kw">as_tibble</span>()</span>
<span id="cb38-22"><a href="data-sources.html#cb38-22" aria-hidden="true"></a>      )</span>
<span id="cb38-23"><a href="data-sources.html#cb38-23" aria-hidden="true"></a>    ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-24"><a href="data-sources.html#cb38-24" aria-hidden="true"></a><span class="st">    </span><span class="kw">unnest</span>(<span class="dt">keep_empty =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Now we have a database with the observations equal to Country*Census observations.  From here we can calculate latest census, etc.</span></span>
<span id="cb38-25"><a href="data-sources.html#cb38-25" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">indicator_date=</span><span class="kw">as.numeric</span>(value)) <span class="op">%&gt;%</span></span>
<span id="cb38-26"><a href="data-sources.html#cb38-26" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="st">&#39;country&#39;</span>,<span class="st">&#39;indicator_date&#39;</span>,<span class="st">&#39;input_var&#39;</span>)</span>
<span id="cb38-27"><a href="data-sources.html#cb38-27" aria-hidden="true"></a>  </span>
<span id="cb38-28"><a href="data-sources.html#cb38-28" aria-hidden="true"></a>    <span class="co">#append nada data on surveys</span></span>
<span id="cb38-29"><a href="data-sources.html#cb38-29" aria-hidden="true"></a>  cs_df &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span></span>
<span id="cb38-30"><a href="data-sources.html#cb38-30" aria-hidden="true"></a><span class="st">    </span><span class="kw">bind_rows</span>(<span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/&#39;</span>, data, <span class="st">&quot;_NADA.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> ))) <span class="op">%&gt;%</span></span>
<span id="cb38-31"><a href="data-sources.html#cb38-31" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(country, indicator_date) <span class="op">%&gt;%</span></span>
<span id="cb38-32"><a href="data-sources.html#cb38-32" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">input_var=</span><span class="kw">first</span>(<span class="kw">na.omit</span>(input_var)  ),</span>
<span id="cb38-33"><a href="data-sources.html#cb38-33" aria-hidden="true"></a>            <span class="dt">nada_dates=</span><span class="kw">first</span>(<span class="kw">na.omit</span>(nada_dates)  ) </span>
<span id="cb38-34"><a href="data-sources.html#cb38-34" aria-hidden="true"></a>             )</span>
<span id="cb38-35"><a href="data-sources.html#cb38-35" aria-hidden="true"></a>    </span>
<span id="cb38-36"><a href="data-sources.html#cb38-36" aria-hidden="true"></a>  </span>
<span id="cb38-37"><a href="data-sources.html#cb38-37" aria-hidden="true"></a>  <span class="co">#Now calculate our SPI score for this indicator</span></span>
<span id="cb38-38"><a href="data-sources.html#cb38-38" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2004</span><span class="op">:</span><span class="dv">2019</span>) {</span>
<span id="cb38-39"><a href="data-sources.html#cb38-39" aria-hidden="true"></a>   temp &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span></span>
<span id="cb38-40"><a href="data-sources.html#cb38-40" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">date=</span>i) <span class="op">%&gt;%</span></span>
<span id="cb38-41"><a href="data-sources.html#cb38-41" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">recency_indicator=</span>((date<span class="op">&gt;=</span>indicator_date)) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#restrict to censuses that do not occur after reference date</span></span>
<span id="cb38-42"><a href="data-sources.html#cb38-42" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">indicator_date=</span><span class="kw">if_else</span>(recency_indicator<span class="op">==</span><span class="ot">TRUE</span>, indicator_date, <span class="kw">as.numeric</span>(<span class="ot">NA</span>))) <span class="op">%&gt;%</span></span>
<span id="cb38-43"><a href="data-sources.html#cb38-43" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(country, date) <span class="op">%&gt;%</span></span>
<span id="cb38-44"><a href="data-sources.html#cb38-44" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">last_val=</span><span class="kw">max</span>(indicator_date, <span class="dt">na.rm=</span>T),</span>
<span id="cb38-45"><a href="data-sources.html#cb38-45" aria-hidden="true"></a>      <span class="dt">input_var=</span><span class="kw">first</span>(input_var),</span>
<span id="cb38-46"><a href="data-sources.html#cb38-46" aria-hidden="true"></a>      <span class="dt">nada_dates=</span><span class="kw">first</span>(nada_dates)) <span class="op">%&gt;%</span></span>
<span id="cb38-47"><a href="data-sources.html#cb38-47" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">indicator=</span><span class="kw">case_when</span>(</span>
<span id="cb38-48"><a href="data-sources.html#cb38-48" aria-hidden="true"></a>      (date<span class="op">-</span>last_val<span class="op">&lt;=</span><span class="dv">10</span>) <span class="op">&amp;</span><span class="st"> </span>(date<span class="op">-</span>last_val<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb38-49"><a href="data-sources.html#cb38-49" aria-hidden="true"></a>      (date<span class="op">-</span>last_val<span class="op">&lt;=</span><span class="dv">20</span>) <span class="op">&amp;</span><span class="st"> </span>(date<span class="op">-</span>last_val<span class="op">&gt;</span><span class="dv">0</span>) <span class="op">~</span><span class="st"> </span><span class="fl">0.5</span>,</span>
<span id="cb38-50"><a href="data-sources.html#cb38-50" aria-hidden="true"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span> )</span>
<span id="cb38-51"><a href="data-sources.html#cb38-51" aria-hidden="true"></a>    )  <span class="op">%&gt;%</span></span>
<span id="cb38-52"><a href="data-sources.html#cb38-52" aria-hidden="true"></a><span class="st">     </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb38-53"><a href="data-sources.html#cb38-53" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="kw">c</span>( <span class="st">&#39;country&#39;</span>, <span class="st">&#39;date&#39;</span>, <span class="st">&#39;input_var&#39;</span>,<span class="st">&#39;nada_dates&#39;</span>, <span class="st">&#39;indicator&#39;</span>)  ) <span class="op">%&gt;%</span></span>
<span id="cb38-54"><a href="data-sources.html#cb38-54" aria-hidden="true"></a><span class="st">    </span><span class="kw">arrange</span>(date, country)</span>
<span id="cb38-55"><a href="data-sources.html#cb38-55" aria-hidden="true"></a></span>
<span id="cb38-56"><a href="data-sources.html#cb38-56" aria-hidden="true"></a>    <span class="kw">assign</span>(<span class="kw">paste</span>(<span class="st">&#39;temp&#39;</span>,i,<span class="dt">sep=</span><span class="st">&quot;_&quot;</span>), temp)</span>
<span id="cb38-57"><a href="data-sources.html#cb38-57" aria-hidden="true"></a>  }</span>
<span id="cb38-58"><a href="data-sources.html#cb38-58" aria-hidden="true"></a></span>
<span id="cb38-59"><a href="data-sources.html#cb38-59" aria-hidden="true"></a>  temp &lt;-<span class="st"> </span>temp_<span class="dv">2019</span></span>
<span id="cb38-60"><a href="data-sources.html#cb38-60" aria-hidden="true"></a>  </span>
<span id="cb38-61"><a href="data-sources.html#cb38-61" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2004</span><span class="op">:</span><span class="dv">2018</span>) {</span>
<span id="cb38-62"><a href="data-sources.html#cb38-62" aria-hidden="true"></a>    temp &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(temp, <span class="kw">get</span>(<span class="kw">paste</span>(<span class="st">&#39;temp&#39;</span>,i,<span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)))</span>
<span id="cb38-63"><a href="data-sources.html#cb38-63" aria-hidden="true"></a>  }</span>
<span id="cb38-64"><a href="data-sources.html#cb38-64" aria-hidden="true"></a>  temp</span>
<span id="cb38-65"><a href="data-sources.html#cb38-65" aria-hidden="true"></a>}</span>
<span id="cb38-66"><a href="data-sources.html#cb38-66" aria-hidden="true"></a></span>
<span id="cb38-67"><a href="data-sources.html#cb38-67" aria-hidden="true"></a></span>
<span id="cb38-68"><a href="data-sources.html#cb38-68" aria-hidden="true"></a></span>
<span id="cb38-69"><a href="data-sources.html#cb38-69" aria-hidden="true"></a>survey_fun  &lt;-<span class="st"> </span><span class="cf">function</span>(data, input_var) {</span>
<span id="cb38-70"><a href="data-sources.html#cb38-70" aria-hidden="true"></a>  </span>
<span id="cb38-71"><a href="data-sources.html#cb38-71" aria-hidden="true"></a>  data &lt;-<span class="st"> </span>data</span>
<span id="cb38-72"><a href="data-sources.html#cb38-72" aria-hidden="true"></a>  input_var &lt;-<span class="st"> </span>input_var</span>
<span id="cb38-73"><a href="data-sources.html#cb38-73" aria-hidden="true"></a></span>
<span id="cb38-74"><a href="data-sources.html#cb38-74" aria-hidden="true"></a>  <span class="co">#read in csv file that was manually collected.</span></span>
<span id="cb38-75"><a href="data-sources.html#cb38-75" aria-hidden="true"></a>  cs_df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/raw/&#39;</span>, data, <span class="st">&quot;_145.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> )) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#bring in data collected for an original set of 145 countries, then an additional 10, then several more high income counries.</span></span>
<span id="cb38-76"><a href="data-sources.html#cb38-76" aria-hidden="true"></a><span class="st">    </span><span class="kw">bind_rows</span>(<span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/raw/&#39;</span>, data, <span class="st">&quot;_10.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> ))) <span class="op">%&gt;%</span></span>
<span id="cb38-77"><a href="data-sources.html#cb38-77" aria-hidden="true"></a><span class="st">    </span><span class="kw">bind_rows</span>(<span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/raw/&#39;</span>, data, <span class="st">&quot;_high.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> ))) <span class="op">%&gt;%</span><span class="st">            </span></span>
<span id="cb38-78"><a href="data-sources.html#cb38-78" aria-hidden="true"></a><span class="st">    </span><span class="kw">write_excel_csv</span>(<span class="dt">path =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/&#39;</span>, data, <span class="st">&quot;_manual.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> )) <span class="op">%&gt;%</span></span>
<span id="cb38-79"><a href="data-sources.html#cb38-79" aria-hidden="true"></a><span class="st">    </span><span class="kw">distinct</span>() <span class="op">%&gt;%</span></span>
<span id="cb38-80"><a href="data-sources.html#cb38-80" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>( country) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-81"><a href="data-sources.html#cb38-81" aria-hidden="true"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">input_var =</span> <span class="op">!!</span><span class="st"> </span>input_var) <span class="op">%&gt;%</span></span>
<span id="cb38-82"><a href="data-sources.html#cb38-82" aria-hidden="true"></a><span class="st">    </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># The next chunk of code will split our string with the years of the census (i.e. &quot;2000, 2010&quot;) in to separate rows.  We will then aggregate up.</span></span>
<span id="cb38-83"><a href="data-sources.html#cb38-83" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(</span>
<span id="cb38-84"><a href="data-sources.html#cb38-84" aria-hidden="true"></a>      <span class="dt">temp_col =</span> <span class="kw">map</span>(</span>
<span id="cb38-85"><a href="data-sources.html#cb38-85" aria-hidden="true"></a>        data, </span>
<span id="cb38-86"><a href="data-sources.html#cb38-86" aria-hidden="true"></a>        <span class="op">~</span><span class="st"> </span><span class="kw">str_extract_all</span>(.x<span class="op">$</span>input_var, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">d{4}&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-87"><a href="data-sources.html#cb38-87" aria-hidden="true"></a><span class="st">          </span><span class="kw">flatten</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-88"><a href="data-sources.html#cb38-88" aria-hidden="true"></a><span class="st">          </span><span class="kw">map_chr</span>(<span class="op">~</span><span class="kw">return</span>(.x)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-89"><a href="data-sources.html#cb38-89" aria-hidden="true"></a><span class="st">          </span><span class="kw">as_tibble</span>()</span>
<span id="cb38-90"><a href="data-sources.html#cb38-90" aria-hidden="true"></a>      )</span>
<span id="cb38-91"><a href="data-sources.html#cb38-91" aria-hidden="true"></a>    ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-92"><a href="data-sources.html#cb38-92" aria-hidden="true"></a><span class="st">    </span><span class="kw">unnest</span>(<span class="dt">keep_empty =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Now we have a database with the observations equal to Country*Census observations.  From here we can calculate latest census, etc.</span></span>
<span id="cb38-93"><a href="data-sources.html#cb38-93" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">indicator_date=</span><span class="kw">as.numeric</span>(value)) <span class="op">%&gt;%</span></span>
<span id="cb38-94"><a href="data-sources.html#cb38-94" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="st">&#39;country&#39;</span>,<span class="st">&#39;indicator_date&#39;</span>,<span class="st">&#39;input_var&#39;</span>)</span>
<span id="cb38-95"><a href="data-sources.html#cb38-95" aria-hidden="true"></a>  </span>
<span id="cb38-96"><a href="data-sources.html#cb38-96" aria-hidden="true"></a>  <span class="co">#append nada data on surveys</span></span>
<span id="cb38-97"><a href="data-sources.html#cb38-97" aria-hidden="true"></a>  cs_df &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span></span>
<span id="cb38-98"><a href="data-sources.html#cb38-98" aria-hidden="true"></a><span class="st">    </span><span class="kw">bind_rows</span>(<span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="kw">paste</span>(raw_dir, <span class="st">&#39;/4.1_SOCS/&#39;</span>, data, <span class="st">&quot;_NADA.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span> ),</span>
<span id="cb38-99"><a href="data-sources.html#cb38-99" aria-hidden="true"></a>                       <span class="dt">col_types =</span> <span class="kw">list</span>(<span class="kw">col_character</span>(),<span class="kw">col_double</span>(), <span class="kw">col_character</span>()))) <span class="op">%&gt;%</span></span>
<span id="cb38-100"><a href="data-sources.html#cb38-100" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(country, indicator_date) <span class="op">%&gt;%</span></span>
<span id="cb38-101"><a href="data-sources.html#cb38-101" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">input_var=</span><span class="kw">first</span>(<span class="kw">na.omit</span>(input_var)  ),</span>
<span id="cb38-102"><a href="data-sources.html#cb38-102" aria-hidden="true"></a>            <span class="dt">nada_dates=</span><span class="kw">first</span>(<span class="kw">na.omit</span>(nada_dates)  ) </span>
<span id="cb38-103"><a href="data-sources.html#cb38-103" aria-hidden="true"></a>             )</span>
<span id="cb38-104"><a href="data-sources.html#cb38-104" aria-hidden="true"></a>    </span>
<span id="cb38-105"><a href="data-sources.html#cb38-105" aria-hidden="true"></a>  </span>
<span id="cb38-106"><a href="data-sources.html#cb38-106" aria-hidden="true"></a>  <span class="co">#Now calculate our SPI score for this indicator</span></span>
<span id="cb38-107"><a href="data-sources.html#cb38-107" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2004</span><span class="op">:</span><span class="dv">2019</span>) {</span>
<span id="cb38-108"><a href="data-sources.html#cb38-108" aria-hidden="true"></a>   temp &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span></span>
<span id="cb38-109"><a href="data-sources.html#cb38-109" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">date=</span>i) <span class="op">%&gt;%</span></span>
<span id="cb38-110"><a href="data-sources.html#cb38-110" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">window=</span><span class="kw">case_when</span>( <span class="co">#extend the window for more recent years.  For instance, 2019 surveys are reported with a lag, so give them two year grace period</span></span>
<span id="cb38-111"><a href="data-sources.html#cb38-111" aria-hidden="true"></a>      date<span class="op">==</span><span class="dv">2019</span> <span class="op">~</span><span class="st"> </span><span class="dv">12</span>,</span>
<span id="cb38-112"><a href="data-sources.html#cb38-112" aria-hidden="true"></a>      date<span class="op">==</span><span class="dv">2018</span> <span class="op">~</span><span class="st"> </span><span class="dv">11</span>,</span>
<span id="cb38-113"><a href="data-sources.html#cb38-113" aria-hidden="true"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">10</span></span>
<span id="cb38-114"><a href="data-sources.html#cb38-114" aria-hidden="true"></a>    )) <span class="op">%&gt;%</span></span>
<span id="cb38-115"><a href="data-sources.html#cb38-115" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">recency_indicator=</span>((date<span class="op">-</span>indicator_date<span class="op">&lt;=</span>window) <span class="op">&amp;</span><span class="st"> </span>(date<span class="op">-</span>indicator_date<span class="op">&gt;=</span><span class="dv">0</span>)) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#restrict to surveys inside 10 year period </span></span>
<span id="cb38-116"><a href="data-sources.html#cb38-116" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>( country, date) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#group by country and create indicator for how many surveys over 10 year period</span></span>
<span id="cb38-117"><a href="data-sources.html#cb38-117" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">indicator=</span><span class="kw">case_when</span>(</span>
<span id="cb38-118"><a href="data-sources.html#cb38-118" aria-hidden="true"></a>      <span class="kw">sum</span>(recency_indicator)<span class="op">&gt;=</span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb38-119"><a href="data-sources.html#cb38-119" aria-hidden="true"></a>      <span class="kw">sum</span>(recency_indicator)<span class="op">==</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.6</span>, </span>
<span id="cb38-120"><a href="data-sources.html#cb38-120" aria-hidden="true"></a>      <span class="kw">sum</span>(recency_indicator)<span class="op">==</span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.3</span>, </span>
<span id="cb38-121"><a href="data-sources.html#cb38-121" aria-hidden="true"></a>      <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="dv">0</span> ),</span>
<span id="cb38-122"><a href="data-sources.html#cb38-122" aria-hidden="true"></a>      <span class="dt">input_var=</span><span class="kw">first</span>(input_var),</span>
<span id="cb38-123"><a href="data-sources.html#cb38-123" aria-hidden="true"></a>      <span class="dt">nada_dates=</span><span class="kw">first</span>(nada_dates)) <span class="op">%&gt;%</span></span>
<span id="cb38-124"><a href="data-sources.html#cb38-124" aria-hidden="true"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb38-125"><a href="data-sources.html#cb38-125" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="kw">c</span>( <span class="st">&#39;country&#39;</span>, <span class="st">&#39;date&#39;</span>, <span class="st">&#39;input_var&#39;</span>,<span class="st">&#39;nada_dates&#39;</span>, <span class="st">&#39;indicator&#39;</span>)  ) <span class="op">%&gt;%</span></span>
<span id="cb38-126"><a href="data-sources.html#cb38-126" aria-hidden="true"></a><span class="st">  </span><span class="kw">arrange</span>(date, country)</span>
<span id="cb38-127"><a href="data-sources.html#cb38-127" aria-hidden="true"></a></span>
<span id="cb38-128"><a href="data-sources.html#cb38-128" aria-hidden="true"></a>    <span class="kw">assign</span>(<span class="kw">paste</span>(<span class="st">&#39;temp&#39;</span>,i,<span class="dt">sep=</span><span class="st">&quot;_&quot;</span>), temp)</span>
<span id="cb38-129"><a href="data-sources.html#cb38-129" aria-hidden="true"></a>  }</span>
<span id="cb38-130"><a href="data-sources.html#cb38-130" aria-hidden="true"></a></span>
<span id="cb38-131"><a href="data-sources.html#cb38-131" aria-hidden="true"></a>  temp &lt;-<span class="st"> </span>temp_<span class="dv">2019</span></span>
<span id="cb38-132"><a href="data-sources.html#cb38-132" aria-hidden="true"></a>  </span>
<span id="cb38-133"><a href="data-sources.html#cb38-133" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2004</span><span class="op">:</span><span class="dv">2018</span>) {</span>
<span id="cb38-134"><a href="data-sources.html#cb38-134" aria-hidden="true"></a>    temp &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(temp, <span class="kw">get</span>(<span class="kw">paste</span>(<span class="st">&#39;temp&#39;</span>,i,<span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)))</span>
<span id="cb38-135"><a href="data-sources.html#cb38-135" aria-hidden="true"></a>  }</span>
<span id="cb38-136"><a href="data-sources.html#cb38-136" aria-hidden="true"></a>  temp</span>
<span id="cb38-137"><a href="data-sources.html#cb38-137" aria-hidden="true"></a>}</span>
<span id="cb38-138"><a href="data-sources.html#cb38-138" aria-hidden="true"></a></span>
<span id="cb38-139"><a href="data-sources.html#cb38-139" aria-hidden="true"></a></span>
<span id="cb38-140"><a href="data-sources.html#cb38-140" aria-hidden="true"></a><span class="co">#Population Censuses</span></span>
<span id="cb38-141"><a href="data-sources.html#cb38-141" aria-hidden="true"></a>cs1_df &lt;-pop_census_df <span class="op">%&gt;%</span></span>
<span id="cb38-142"><a href="data-sources.html#cb38-142" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">RAW.D4.1.1.POPU.CENSUS=</span>Latest.population.census,</span>
<span id="cb38-143"><a href="data-sources.html#cb38-143" aria-hidden="true"></a>         <span class="dt">SPI.D4.1.1.POPU=</span>indicator) <span class="op">%&gt;%</span></span>
<span id="cb38-144"><a href="data-sources.html#cb38-144" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(iso3c, date, <span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;RAW&quot;</span>))</span>
<span id="cb38-145"><a href="data-sources.html#cb38-145" aria-hidden="true"></a></span>
<span id="cb38-146"><a href="data-sources.html#cb38-146" aria-hidden="true"></a><span class="co">#Agriculture census  </span></span>
<span id="cb38-147"><a href="data-sources.html#cb38-147" aria-hidden="true"></a>cs2_df &lt;-ag_census_df <span class="op">%&gt;%</span></span>
<span id="cb38-148"><a href="data-sources.html#cb38-148" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">RAW.D4.1.2.AGRI.CENSUS=</span>Latest.agricultural.census,</span>
<span id="cb38-149"><a href="data-sources.html#cb38-149" aria-hidden="true"></a>         <span class="dt">SPI.D4.1.2.AGRI=</span>indicator) <span class="op">%&gt;%</span></span>
<span id="cb38-150"><a href="data-sources.html#cb38-150" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(iso3c, date, <span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;RAW&quot;</span>))</span>
<span id="cb38-151"><a href="data-sources.html#cb38-151" aria-hidden="true"></a></span>
<span id="cb38-152"><a href="data-sources.html#cb38-152" aria-hidden="true"></a><span class="co">#Business/establishment census </span></span>
<span id="cb38-153"><a href="data-sources.html#cb38-153" aria-hidden="true"></a>cs3_df &lt;-<span class="kw">census_fun</span>(<span class="st">&#39;D4.1.3.CEN.BIZZ&#39;</span>, <span class="st">&#39;BIZZ.CENSUS&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb38-154"><a href="data-sources.html#cb38-154" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">RAW.D4.1.3.BIZZ.CENSUS=</span>input_var,</span>
<span id="cb38-155"><a href="data-sources.html#cb38-155" aria-hidden="true"></a>         <span class="dt">RAW.D4.1.3.BIZZ.CENSUS_nada=</span>nada_dates,</span>
<span id="cb38-156"><a href="data-sources.html#cb38-156" aria-hidden="true"></a>         <span class="dt">SPI.D4.1.3.BIZZ=</span>indicator) <span class="op">%&gt;%</span></span>
<span id="cb38-157"><a href="data-sources.html#cb38-157" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(country, date, <span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;RAW&quot;</span>))</span>
<span id="cb38-158"><a href="data-sources.html#cb38-158" aria-hidden="true"></a></span>
<span id="cb38-159"><a href="data-sources.html#cb38-159" aria-hidden="true"></a><span class="co">#Household Survey on income/ consumption/ expenditure/ budget/ Integrated Survey</span></span>
<span id="cb38-160"><a href="data-sources.html#cb38-160" aria-hidden="true"></a>cs4_df &lt;-<span class="kw">survey_fun</span>(<span class="st">&#39;D4.1.4.SVY.HOUS&#39;</span>, <span class="st">&#39;HOUS.SURVEYS&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb38-161"><a href="data-sources.html#cb38-161" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">RAW.D4.1.4.HOUS.SURVEYS=</span>input_var,</span>
<span id="cb38-162"><a href="data-sources.html#cb38-162" aria-hidden="true"></a>         <span class="dt">RAW.D4.1.4.HOUS.SURVEYS_nada=</span>nada_dates,</span>
<span id="cb38-163"><a href="data-sources.html#cb38-163" aria-hidden="true"></a>         <span class="dt">SPI.D4.1.4.HOUS=</span>indicator) <span class="op">%&gt;%</span></span>
<span id="cb38-164"><a href="data-sources.html#cb38-164" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(country, date, <span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;RAW&quot;</span>))</span>
<span id="cb38-165"><a href="data-sources.html#cb38-165" aria-hidden="true"></a></span>
<span id="cb38-166"><a href="data-sources.html#cb38-166" aria-hidden="true"></a><span class="co">#Agriculture survey </span></span>
<span id="cb38-167"><a href="data-sources.html#cb38-167" aria-hidden="true"></a>cs5_df &lt;-<span class="kw">survey_fun</span>(<span class="st">&#39;D4.1.5.SVY.AGRI&#39;</span>, <span class="st">&#39;AGRI.SURVEYS&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb38-168"><a href="data-sources.html#cb38-168" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">RAW.D4.1.5.AGRI.SURVEYS=</span>input_var,</span>
<span id="cb38-169"><a href="data-sources.html#cb38-169" aria-hidden="true"></a>         <span class="dt">RAW.D4.1.5.AGRI.SURVEYS_nada=</span>nada_dates,</span>
<span id="cb38-170"><a href="data-sources.html#cb38-170" aria-hidden="true"></a>         <span class="dt">SPI.D4.1.5.AGSVY=</span>indicator) <span class="op">%&gt;%</span></span>
<span id="cb38-171"><a href="data-sources.html#cb38-171" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(country, date, <span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;RAW&quot;</span>))</span>
<span id="cb38-172"><a href="data-sources.html#cb38-172" aria-hidden="true"></a></span>
<span id="cb38-173"><a href="data-sources.html#cb38-173" aria-hidden="true"></a><span class="co">#Labor Force Survey </span></span>
<span id="cb38-174"><a href="data-sources.html#cb38-174" aria-hidden="true"></a>cs6_df &lt;-<span class="kw">survey_fun</span>(<span class="st">&#39;D4.1.6.SVY.LABR&#39;</span>, <span class="st">&#39;LABR.SURVEYS&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb38-175"><a href="data-sources.html#cb38-175" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">RAW.D4.1.6.LABR.SURVEYS=</span>input_var,</span>
<span id="cb38-176"><a href="data-sources.html#cb38-176" aria-hidden="true"></a>         <span class="dt">RAW.D4.1.6.LABR.SURVEYS_nada=</span>nada_dates,</span>
<span id="cb38-177"><a href="data-sources.html#cb38-177" aria-hidden="true"></a>         <span class="dt">SPI.D4.1.6.LABR=</span>indicator) <span class="op">%&gt;%</span></span>
<span id="cb38-178"><a href="data-sources.html#cb38-178" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(country, date, <span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;RAW&quot;</span>))</span>
<span id="cb38-179"><a href="data-sources.html#cb38-179" aria-hidden="true"></a></span>
<span id="cb38-180"><a href="data-sources.html#cb38-180" aria-hidden="true"></a><span class="co">#Health/Demographic survey</span></span>
<span id="cb38-181"><a href="data-sources.html#cb38-181" aria-hidden="true"></a>cs7_df &lt;-<span class="kw">survey_fun</span>(<span class="st">&#39;D4.1.7.SVY.HLTH&#39;</span>, <span class="st">&#39;HLTH.SURVEYS&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb38-182"><a href="data-sources.html#cb38-182" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">RAW.D4.1.7.HLTH.SURVEYS=</span>input_var,</span>
<span id="cb38-183"><a href="data-sources.html#cb38-183" aria-hidden="true"></a>         <span class="dt">RAW.D4.1.7.HLTH.SURVEYS_nada=</span>nada_dates,</span>
<span id="cb38-184"><a href="data-sources.html#cb38-184" aria-hidden="true"></a>         <span class="dt">SPI.D4.1.7.HLTH=</span>indicator) <span class="op">%&gt;%</span></span>
<span id="cb38-185"><a href="data-sources.html#cb38-185" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(country, date, <span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;RAW&quot;</span>))</span>
<span id="cb38-186"><a href="data-sources.html#cb38-186" aria-hidden="true"></a></span>
<span id="cb38-187"><a href="data-sources.html#cb38-187" aria-hidden="true"></a><span class="co">#Business/establishment survey  </span></span>
<span id="cb38-188"><a href="data-sources.html#cb38-188" aria-hidden="true"></a>cs8_df &lt;-<span class="kw">survey_fun</span>(<span class="st">&#39;D4.1.8.SVY.BIZZ&#39;</span>, <span class="st">&#39;BIZZ.SURVEYS&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb38-189"><a href="data-sources.html#cb38-189" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">RAW.D4.1.8.BIZZ.SURVEYS=</span>input_var,</span>
<span id="cb38-190"><a href="data-sources.html#cb38-190" aria-hidden="true"></a>         <span class="dt">RAW.D4.1.8.BIZZ.SURVEYS_nada=</span>nada_dates,</span>
<span id="cb38-191"><a href="data-sources.html#cb38-191" aria-hidden="true"></a>         <span class="dt">SPI.D4.1.8.BZSVY=</span>indicator) <span class="op">%&gt;%</span></span>
<span id="cb38-192"><a href="data-sources.html#cb38-192" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(country, date, <span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), <span class="kw">starts_with</span>(<span class="st">&quot;RAW&quot;</span>))</span>
<span id="cb38-193"><a href="data-sources.html#cb38-193" aria-hidden="true"></a></span>
<span id="cb38-194"><a href="data-sources.html#cb38-194" aria-hidden="true"></a></span>
<span id="cb38-195"><a href="data-sources.html#cb38-195" aria-hidden="true"></a><span class="co">#brind all censuses and surveys together</span></span>
<span id="cb38-196"><a href="data-sources.html#cb38-196" aria-hidden="true"></a>cs_df &lt;-<span class="st"> </span>spi_df_empty <span class="op">%&gt;%</span></span>
<span id="cb38-197"><a href="data-sources.html#cb38-197" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(cs1_df) <span class="op">%&gt;%</span></span>
<span id="cb38-198"><a href="data-sources.html#cb38-198" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(cs2_df) <span class="op">%&gt;%</span></span>
<span id="cb38-199"><a href="data-sources.html#cb38-199" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(cs3_df) <span class="op">%&gt;%</span></span>
<span id="cb38-200"><a href="data-sources.html#cb38-200" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(cs4_df) <span class="op">%&gt;%</span></span>
<span id="cb38-201"><a href="data-sources.html#cb38-201" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(cs5_df) <span class="op">%&gt;%</span></span>
<span id="cb38-202"><a href="data-sources.html#cb38-202" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(cs6_df) <span class="op">%&gt;%</span></span>
<span id="cb38-203"><a href="data-sources.html#cb38-203" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(cs7_df) <span class="op">%&gt;%</span></span>
<span id="cb38-204"><a href="data-sources.html#cb38-204" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(cs8_df) </span>
<span id="cb38-205"><a href="data-sources.html#cb38-205" aria-hidden="true"></a></span>
<span id="cb38-206"><a href="data-sources.html#cb38-206" aria-hidden="true"></a><span class="co">#add to spi databases</span></span>
<span id="cb38-207"><a href="data-sources.html#cb38-207" aria-hidden="true"></a>spi_df &lt;-<span class="st"> </span>spi_df <span class="op">%&gt;%</span></span>
<span id="cb38-208"><a href="data-sources.html#cb38-208" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(cs_df)</span>
<span id="cb38-209"><a href="data-sources.html#cb38-209" aria-hidden="true"></a></span>
<span id="cb38-210"><a href="data-sources.html#cb38-210" aria-hidden="true"></a><span class="co">#now do the figures </span></span>
<span id="cb38-211"><a href="data-sources.html#cb38-211" aria-hidden="true"></a>cs_df_map &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(SPI.D4.<span class="dv">1</span>.<span class="fl">1.</span>POPU))</span>
<span id="cb38-212"><a href="data-sources.html#cb38-212" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;cs_df_map&#39;</span>, <span class="st">&#39;SPI.D4.1.1.POPU&#39;</span>, <span class="st">&#39;Population Census Available in Past 20 Years in 2019&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/cs-1.png" width="960" /><img src="01_data_prep_files/figure-html/cs-2.png" width="960" /><img src="01_data_prep_files/figure-html/cs-3.png" width="960" /><img src="01_data_prep_files/figure-html/cs-4.png" width="960" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="data-sources.html#cb39-1" aria-hidden="true"></a>cs_df_map &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(SPI.D4.<span class="dv">1</span>.<span class="fl">2.</span>AGRI))</span>
<span id="cb39-2"><a href="data-sources.html#cb39-2" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;cs_df_map&#39;</span>, <span class="st">&#39;SPI.D4.1.2.AGRI&#39;</span>, <span class="st">&#39;Agriculture Census Available in Past 20 Years in 2019&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/cs-5.png" width="960" /><img src="01_data_prep_files/figure-html/cs-6.png" width="960" /><img src="01_data_prep_files/figure-html/cs-7.png" width="960" /><img src="01_data_prep_files/figure-html/cs-8.png" width="960" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="data-sources.html#cb40-1" aria-hidden="true"></a>cs_df_map &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(SPI.D4.<span class="dv">1</span>.<span class="fl">3.</span>BIZZ))</span>
<span id="cb40-2"><a href="data-sources.html#cb40-2" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;cs_df_map&#39;</span>, <span class="st">&#39;SPI.D4.1.3.BIZZ&#39;</span>, <span class="st">&#39;Business/Establishment Census Available in Past 20 Years in 2019&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/cs-9.png" width="960" /><img src="01_data_prep_files/figure-html/cs-10.png" width="960" /><img src="01_data_prep_files/figure-html/cs-11.png" width="960" /><img src="01_data_prep_files/figure-html/cs-12.png" width="960" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data-sources.html#cb41-1" aria-hidden="true"></a>cs_df_map &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(SPI.D4.<span class="dv">1</span>.<span class="fl">4.</span>HOUS))</span>
<span id="cb41-2"><a href="data-sources.html#cb41-2" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;cs_df_map&#39;</span>, <span class="st">&#39;SPI.D4.1.4.HOUS&#39;</span>, <span class="st">&#39;Household Survey Availablility in Past 10 Years in 2019&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/cs-13.png" width="960" /><img src="01_data_prep_files/figure-html/cs-14.png" width="960" /><img src="01_data_prep_files/figure-html/cs-15.png" width="960" /><img src="01_data_prep_files/figure-html/cs-16.png" width="960" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="data-sources.html#cb42-1" aria-hidden="true"></a>cs_df_map &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(SPI.D4.<span class="dv">1</span>.<span class="fl">5.</span>AGSVY))</span>
<span id="cb42-2"><a href="data-sources.html#cb42-2" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;cs_df_map&#39;</span>, <span class="st">&#39;SPI.D4.1.5.AGSVY&#39;</span>, <span class="st">&#39;Agriculture Survey Availablility in Past 10 Years in 2019&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/cs-17.png" width="960" /><img src="01_data_prep_files/figure-html/cs-18.png" width="960" /><img src="01_data_prep_files/figure-html/cs-19.png" width="960" /><img src="01_data_prep_files/figure-html/cs-20.png" width="960" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="data-sources.html#cb43-1" aria-hidden="true"></a>cs_df_map &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(SPI.D4.<span class="dv">1</span>.<span class="fl">6.</span>LABR))</span>
<span id="cb43-2"><a href="data-sources.html#cb43-2" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;cs_df_map&#39;</span>, <span class="st">&#39;SPI.D4.1.6.LABR&#39;</span>, <span class="st">&#39;Labor Force Survey Availablility in Past 10 Years in 2019&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/cs-21.png" width="960" /><img src="01_data_prep_files/figure-html/cs-22.png" width="960" /><img src="01_data_prep_files/figure-html/cs-23.png" width="960" /><img src="01_data_prep_files/figure-html/cs-24.png" width="960" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="data-sources.html#cb44-1" aria-hidden="true"></a>cs_df_map &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(SPI.D4.<span class="dv">1</span>.<span class="fl">7.</span>HLTH))</span>
<span id="cb44-2"><a href="data-sources.html#cb44-2" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;cs_df_map&#39;</span>, <span class="st">&#39;SPI.D4.1.7.HLTH&#39;</span>, <span class="st">&#39;Health Survey Availablility in Past 10 Years in 2019&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/cs-25.png" width="960" /><img src="01_data_prep_files/figure-html/cs-26.png" width="960" /><img src="01_data_prep_files/figure-html/cs-27.png" width="960" /><img src="01_data_prep_files/figure-html/cs-28.png" width="960" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="data-sources.html#cb45-1" aria-hidden="true"></a>cs_df_map &lt;-<span class="st"> </span>cs_df <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(SPI.D4.<span class="dv">1</span>.<span class="fl">8.</span>BZSVY))</span>
<span id="cb45-2"><a href="data-sources.html#cb45-2" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;cs_df_map&#39;</span>, <span class="st">&#39;SPI.D4.1.8.BZSVY&#39;</span>, <span class="st">&#39;Business Survey Availablility in Past 10 Years in 2019&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/cs-29.png" width="960" /><img src="01_data_prep_files/figure-html/cs-30.png" width="960" /><img src="01_data_prep_files/figure-html/cs-31.png" width="960" /><img src="01_data_prep_files/figure-html/cs-32.png" width="960" /></p>
</div>
</div>
</div>
<div id="indicator-4.2-administrative-data" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Indicator 4.2: administrative data</h2>
<p>The following indicator checks whether administrative data is available for the following topic areas: Social Protection, Education, Population &amp; Health, and Labor</p>
<div id="social-protection-admin-data" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Social Protection Admin Data</h3>
<ul>
<li>Atlas of Social Protection Indicators of Resilience and Equity (ASPIRE) is compilation of Social Protection and Labor (SPL) indicators to analyze scope and performance of SPL programs.<br />
</li>
<li>ASPIRE has indicators for 136 countries on:
<ul>
<li>Social assistance<br />
</li>
<li>Social insurance<br />
</li>
<li>Labor market programs</li>
</ul></li>
<li>Based on both program-level administrative data and national household survey data<br />
</li>
<li>Data extends from 2001 to 2018</li>
</ul>
<p>Scoring is 1 if administrative data is available to produce beneficiary counts or expenditures for any social protection and labor program, 0 otherwise. In order to smooth out gaps in reporting, we take a moving 5 year average of the score.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="data-sources.html#cb46-1" aria-hidden="true"></a><span class="co">#read data</span></span>
<span id="cb46-2"><a href="data-sources.html#cb46-2" aria-hidden="true"></a>aspire_df_raw &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">paste</span>(raw_dir, <span class="st">&#39;4.2_SOAD&#39;</span>,<span class="st">&#39;ASPIRE_sources.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb46-3"><a href="data-sources.html#cb46-3" aria-hidden="true"></a></span>
<span id="cb46-4"><a href="data-sources.html#cb46-4" aria-hidden="true"></a><span class="co">#cleaning of aspire data</span></span>
<span id="cb46-5"><a href="data-sources.html#cb46-5" aria-hidden="true"></a>aspire_df &lt;-<span class="st"> </span>aspire_df_raw <span class="op">%&gt;%</span></span>
<span id="cb46-6"><a href="data-sources.html#cb46-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">date=</span><span class="kw">as.numeric</span>(year)) <span class="op">%&gt;%</span></span>
<span id="cb46-7"><a href="data-sources.html#cb46-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(date)) <span class="op">%&gt;%</span></span>
<span id="cb46-8"><a href="data-sources.html#cb46-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>( ccode, date) <span class="op">%&gt;%</span></span>
<span id="cb46-9"><a href="data-sources.html#cb46-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">ben_count_avail=</span>(<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">mean</span>(ben, <span class="dt">na.rm=</span>T))),</span>
<span id="cb46-10"><a href="data-sources.html#cb46-10" aria-hidden="true"></a>              <span class="dt">ben_exp_avail=</span>(<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">mean</span>(exp_b, <span class="dt">na.rm=</span>T)))) <span class="op">%&gt;%</span></span>
<span id="cb46-11"><a href="data-sources.html#cb46-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">iso3c=</span>ccode) <span class="op">%&gt;%</span></span>
<span id="cb46-12"><a href="data-sources.html#cb46-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">left_join</span>(country_metadata) <span class="op">%&gt;%</span></span>
<span id="cb46-13"><a href="data-sources.html#cb46-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">ben_info_avail=</span>(ben_count_avail<span class="op">==</span><span class="ot">TRUE</span> <span class="op">|</span><span class="st"> </span>ben_exp_avail<span class="op">==</span><span class="ot">TRUE</span>)</span>
<span id="cb46-14"><a href="data-sources.html#cb46-14" aria-hidden="true"></a>           )</span>
<span id="cb46-15"><a href="data-sources.html#cb46-15" aria-hidden="true"></a></span>
<span id="cb46-16"><a href="data-sources.html#cb46-16" aria-hidden="true"></a><span class="kw">write_excel_csv</span>(aspire_df, <span class="kw">paste</span>(output_dir, <span class="st">&#39;SPL_admin_data_availability.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb46-17"><a href="data-sources.html#cb46-17" aria-hidden="true"></a></span>
<span id="cb46-18"><a href="data-sources.html#cb46-18" aria-hidden="true"></a><span class="co">#create 5 year moving average</span></span>
<span id="cb46-19"><a href="data-sources.html#cb46-19" aria-hidden="true"></a>aspire_fun &lt;-<span class="st"> </span><span class="cf">function</span>(date_start, date_end) {</span>
<span id="cb46-20"><a href="data-sources.html#cb46-20" aria-hidden="true"></a>  temp &lt;-<span class="st"> </span>aspire_df <span class="op">%&gt;%</span></span>
<span id="cb46-21"><a href="data-sources.html#cb46-21" aria-hidden="true"></a><span class="st">      </span><span class="kw">filter</span>(<span class="kw">between</span>(date,date_start,date_end) ) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb46-22"><a href="data-sources.html#cb46-22" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(iso3c, country) <span class="op">%&gt;%</span></span>
<span id="cb46-23"><a href="data-sources.html#cb46-23" aria-hidden="true"></a><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">ben_info_avail=</span><span class="kw">if_else</span>(ben_info_avail<span class="op">==</span><span class="ot">TRUE</span>,<span class="kw">as.numeric</span>(ben_info_avail), <span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb46-24"><a href="data-sources.html#cb46-24" aria-hidden="true"></a><span class="st">      </span><span class="kw">summarise</span>(<span class="dt">ben_info_avail=</span><span class="kw">round</span>(<span class="kw">mean</span>(ben_info_avail),<span class="dv">1</span>) <span class="co">#get an average of this across countries</span></span>
<span id="cb46-25"><a href="data-sources.html#cb46-25" aria-hidden="true"></a>              ) <span class="op">%&gt;%</span></span>
<span id="cb46-26"><a href="data-sources.html#cb46-26" aria-hidden="true"></a><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">SPI.D4.2.1.SPL=</span><span class="kw">if_else</span>(<span class="kw">is.na</span>(ben_info_avail),<span class="dv">0</span>, ben_info_avail),</span>
<span id="cb46-27"><a href="data-sources.html#cb46-27" aria-hidden="true"></a>            <span class="dt">RAW.D4.2.1.SPL=</span>ben_info_avail) <span class="op">%&gt;%</span></span>
<span id="cb46-28"><a href="data-sources.html#cb46-28" aria-hidden="true"></a><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">date=</span>date_end) <span class="op">%&gt;%</span></span>
<span id="cb46-29"><a href="data-sources.html#cb46-29" aria-hidden="true"></a><span class="st">      </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&#39;iso3c&#39;</span>, <span class="st">&#39;country&#39;</span>, <span class="st">&#39;date&#39;</span>, <span class="st">&#39;RAW.D4.2.1.SPL&#39;</span>, <span class="st">&#39;SPI.D4.2.1.SPL&#39;</span>)  )</span>
<span id="cb46-30"><a href="data-sources.html#cb46-30" aria-hidden="true"></a>      </span>
<span id="cb46-31"><a href="data-sources.html#cb46-31" aria-hidden="true"></a>  </span>
<span id="cb46-32"><a href="data-sources.html#cb46-32" aria-hidden="true"></a></span>
<span id="cb46-33"><a href="data-sources.html#cb46-33" aria-hidden="true"></a>}</span>
<span id="cb46-34"><a href="data-sources.html#cb46-34" aria-hidden="true"></a></span>
<span id="cb46-35"><a href="data-sources.html#cb46-35" aria-hidden="true"></a></span>
<span id="cb46-36"><a href="data-sources.html#cb46-36" aria-hidden="true"></a></span>
<span id="cb46-37"><a href="data-sources.html#cb46-37" aria-hidden="true"></a><span class="co">####</span></span>
<span id="cb46-38"><a href="data-sources.html#cb46-38" aria-hidden="true"></a><span class="co"># X Year moving average</span></span>
<span id="cb46-39"><a href="data-sources.html#cb46-39" aria-hidden="true"></a><span class="co">####</span></span>
<span id="cb46-40"><a href="data-sources.html#cb46-40" aria-hidden="true"></a><span class="co">#create this database for each year from 2004 to 2019 using a X year average</span></span>
<span id="cb46-41"><a href="data-sources.html#cb46-41" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">2004</span><span class="op">:</span><span class="dv">2019</span>)) {</span>
<span id="cb46-42"><a href="data-sources.html#cb46-42" aria-hidden="true"></a>  </span>
<span id="cb46-43"><a href="data-sources.html#cb46-43" aria-hidden="true"></a>  start=i<span class="op">-</span>(window<span class="dv">-1</span>)</span>
<span id="cb46-44"><a href="data-sources.html#cb46-44" aria-hidden="true"></a>  end=i</span>
<span id="cb46-45"><a href="data-sources.html#cb46-45" aria-hidden="true"></a>  </span>
<span id="cb46-46"><a href="data-sources.html#cb46-46" aria-hidden="true"></a>  temp_df &lt;-<span class="st"> </span><span class="kw">aspire_fun</span>(start,end)</span>
<span id="cb46-47"><a href="data-sources.html#cb46-47" aria-hidden="true"></a>  <span class="kw">assign</span>(<span class="kw">paste</span>(<span class="st">&#39;aspire_&#39;</span>,end, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), temp_df)</span>
<span id="cb46-48"><a href="data-sources.html#cb46-48" aria-hidden="true"></a>}</span>
<span id="cb46-49"><a href="data-sources.html#cb46-49" aria-hidden="true"></a></span>
<span id="cb46-50"><a href="data-sources.html#cb46-50" aria-hidden="true"></a><span class="cf">if</span> (<span class="kw">exists</span>(<span class="st">&#39;aspire_df&#39;</span>)) {</span>
<span id="cb46-51"><a href="data-sources.html#cb46-51" aria-hidden="true"></a>  <span class="kw">rm</span>(<span class="st">&#39;aspire_df&#39;</span>)</span>
<span id="cb46-52"><a href="data-sources.html#cb46-52" aria-hidden="true"></a>}</span>
<span id="cb46-53"><a href="data-sources.html#cb46-53" aria-hidden="true"></a><span class="co">#now append together and save</span></span>
<span id="cb46-54"><a href="data-sources.html#cb46-54" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">2004</span><span class="op">:</span><span class="dv">2019</span>)) {</span>
<span id="cb46-55"><a href="data-sources.html#cb46-55" aria-hidden="true"></a>  </span>
<span id="cb46-56"><a href="data-sources.html#cb46-56" aria-hidden="true"></a>  temp&lt;-<span class="kw">get</span>(<span class="kw">paste</span>(<span class="st">&#39;aspire_&#39;</span>,i, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb46-57"><a href="data-sources.html#cb46-57" aria-hidden="true"></a>  </span>
<span id="cb46-58"><a href="data-sources.html#cb46-58" aria-hidden="true"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="kw">exists</span>(<span class="st">&#39;aspire_df&#39;</span>)) {</span>
<span id="cb46-59"><a href="data-sources.html#cb46-59" aria-hidden="true"></a>    aspire_df&lt;-temp</span>
<span id="cb46-60"><a href="data-sources.html#cb46-60" aria-hidden="true"></a>  } <span class="cf">else</span> {</span>
<span id="cb46-61"><a href="data-sources.html#cb46-61" aria-hidden="true"></a>    aspire_df&lt;-aspire_df <span class="op">%&gt;%</span></span>
<span id="cb46-62"><a href="data-sources.html#cb46-62" aria-hidden="true"></a><span class="st">      </span><span class="kw">bind_rows</span>(temp) <span class="op">%&gt;%</span></span>
<span id="cb46-63"><a href="data-sources.html#cb46-63" aria-hidden="true"></a><span class="st">      </span><span class="kw">arrange</span>(<span class="op">-</span>date, iso3c)</span>
<span id="cb46-64"><a href="data-sources.html#cb46-64" aria-hidden="true"></a>  }</span>
<span id="cb46-65"><a href="data-sources.html#cb46-65" aria-hidden="true"></a>}</span>
<span id="cb46-66"><a href="data-sources.html#cb46-66" aria-hidden="true"></a></span>
<span id="cb46-67"><a href="data-sources.html#cb46-67" aria-hidden="true"></a></span>
<span id="cb46-68"><a href="data-sources.html#cb46-68" aria-hidden="true"></a><span class="co">#add to spi databases</span></span>
<span id="cb46-69"><a href="data-sources.html#cb46-69" aria-hidden="true"></a>spi_df &lt;-<span class="st"> </span>spi_df <span class="op">%&gt;%</span></span>
<span id="cb46-70"><a href="data-sources.html#cb46-70" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(aspire_df)</span>
<span id="cb46-71"><a href="data-sources.html#cb46-71" aria-hidden="true"></a></span>
<span id="cb46-72"><a href="data-sources.html#cb46-72" aria-hidden="true"></a>aspire_map &lt;-<span class="st"> </span>aspire_df</span>
<span id="cb46-73"><a href="data-sources.html#cb46-73" aria-hidden="true"></a></span>
<span id="cb46-74"><a href="data-sources.html#cb46-74" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;aspire_map&#39;</span>, <span class="st">&#39;SPI.D4.2.1.SPL&#39;</span>, <span class="st">&#39;Administrative Data Available on Beneficiary Counts or Expenditures using ASPIRE&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/aspire-1.png" width="960" /><img src="01_data_prep_files/figure-html/aspire-2.png" width="960" /><img src="01_data_prep_files/figure-html/aspire-3.png" width="960" /><img src="01_data_prep_files/figure-html/aspire-4.png" width="960" /></p>
</div>
<div id="education-admin-data" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Education Admin Data</h3>
<ul>
<li><p>UNESCO UIS has database containing data we can use on administrative data systems. Database is accessible using the UIS bulk download service at <a href="https://apiportal.uis.unesco.org/bdds" class="uri">https://apiportal.uis.unesco.org/bdds</a>. Data was last updated on September 29, 2020.</p></li>
<li><p>We score countries based on whether there is:</p>
<ul>
<li>Data tracking SDG 4.1.2 Administration of a nationally-representative learning assessment (a) in Grade 2 or 3; (b) at the end of primary education; and (c) at the end of lower secondary education</li>
</ul>
<!-- * Data tracking whether countries produce the following from administrative data sources: -->
<!--     * Out-of-school rate by school age and sex -->
<!--     * 4.2.2 Participation rate in organized learning (one year before the official primary entry age), by sex --></li>
</ul>
<p>In order to score this indicator, we calculate the fraction of the indicators that were produced in a country in a year. In order to smooth out variation from year to year in reporting or conducting national assessments, we take a moving 5 year average.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="data-sources.html#cb47-1" aria-hidden="true"></a><span class="co"># #read data from UNESCO API</span></span>
<span id="cb47-2"><a href="data-sources.html#cb47-2" aria-hidden="true"></a><span class="co"># #get list of indicators to download</span></span>
<span id="cb47-3"><a href="data-sources.html#cb47-3" aria-hidden="true"></a><span class="co"># indicators &lt;- &#39;ADMI_GRADE2OR3PRIM_READ+ADMI_ENDOFPRIM_READ+ADMI_ENDOFLOWERSEC_READ+ADMI_GRADE2OR3PRIM_MAT+ADMI_ENDOFPRIM_MAT+ADMI_ENDOFLOWERSEC_MAT+ROFST_1_CP+ROFST_1_F_CP+ROFST_1_M_CP+ROFST_2_CP+ROFST_2_F_CP+ROFST_2_M_CP+ROFST_3_CP+ROFST_3_F_CP+ROFST_3_M_CP+ROFST_1T2_CP+ROFST_1T2_F_CP+ROFST_1T2_M_CP+ROFST_2T3_CP+ROFST_2T3_F_CP+ROFST_2T3_M_CP+ROFST_1T3_CP+ROFST_1T3_F_CP+ROFST_1T3_M_CP+NERA_AGM1_CP+NERA_AGM1_F_CP+NERA_AGM1_M_CP.&#39;</span></span>
<span id="cb47-4"><a href="data-sources.html#cb47-4" aria-hidden="true"></a><span class="co"># </span></span>
<span id="cb47-5"><a href="data-sources.html#cb47-5" aria-hidden="true"></a><span class="co"># #get list of countries</span></span>
<span id="cb47-6"><a href="data-sources.html#cb47-6" aria-hidden="true"></a><span class="co"># countries &lt;- &#39;AFG+ALB+DZA+ASM+AND+AGO+AIA+ATG+ARG+ARM+ABW+AUS+AUT+AZE+BHS+BHR+BGD+BRB+BLR+BEL+BLZ+BEN+BMU+BTN+BOL+BIH+BWA+BRA+VGB+BRN+BGR+BFA+BDI+KHM+CMR+CAN+CPV+CYM+CAF+TCD+CHL+CHN+HKG+MAC+COL+COM+COG+COK+CRI+CIV+HRV+CUB+CUW+CYP+CZE+PRK+COD+DNK+DJI+DMA+DOM+ECU+EGY+SLV+GNQ+ERI+EST+SWZ+ETH+FJI+FIN+FRA+GUF+PYF+GAB+GMB+GEO+DEU+GHA+GIB+GRC+GRL+GRD+GLP+GUM+GTM+GIN+GNB+GUY+HTI+VAT+HND+HUN+ISL+IND+IDN+IRN+IRQ+IRL+ISR+ITA+JAM+JPN+JOR+KAZ+KEN+KIR+KWT+KGZ+LAO+LVA+LBN+LSO+LBR+LBY+LIE+LTU+LUX+MDG+MWI+MYS+MDV+MLI+MLT+MHL+MTQ+MRT+MUS+MEX+FSM+MCO+MNG+MNE+MSR+MAR+MOZ+MMR+NAM+NRU+NPL+NLD+ANT+NCL+NZL+NIC+NER+NGA+NIU+MKD+NOR+OMN+PAK+PLW+PSE+PAN+PNG+PRY+PER+PHL+POL+PRT+PRI+QAT+KOR+MDA+REU+ROU+RUS+RWA+SHN+KNA+LCA+SPM+VCT+WSM+SMR+STP+SAU+SEN+SRB+SYC+SLE+SGP+SXM+SVK+SVN+SLB+SOM+ZAF+SSD+ESP+LKA+SDN+XDN+SUR+SWE+CHE+SYR+TJK+THA+TLS+TGO+TKL+TON+TTO+TUN+TUR+TKM+TCA+TUV+UGA+UKR+ARE+GBR+TZA+USA+URY+UZB+VUT+VEN+VNM+WLF+YEM+ZMB+ZWE+SDG+40675+40330+40334+40344+40606+40617+40603+40614+40618+40612+40616+40619+40611+40613+40630+40650+40651+40656+40642+40620+40640+UIS+40510+40525+40530+40505+40515+40520+40500+40535+40540+40550+WB+40044+40042+40030+40043+40041/all&#39;</span></span>
<span id="cb47-7"><a href="data-sources.html#cb47-7" aria-hidden="true"></a><span class="co"># </span></span>
<span id="cb47-8"><a href="data-sources.html#cb47-8" aria-hidden="true"></a><span class="co"># start &lt;- &#39;2000&#39;</span></span>
<span id="cb47-9"><a href="data-sources.html#cb47-9" aria-hidden="true"></a><span class="co"># end &lt;- &#39;2019&#39;</span></span>
<span id="cb47-10"><a href="data-sources.html#cb47-10" aria-hidden="true"></a><span class="co"># </span></span>
<span id="cb47-11"><a href="data-sources.html#cb47-11" aria-hidden="true"></a><span class="co"># #build the API query</span></span>
<span id="cb47-12"><a href="data-sources.html#cb47-12" aria-hidden="true"></a><span class="co"># url &lt;- paste(&#39;http://api.uis.unesco.org/sdmx.ashx/GetData/SDG4_DS/&#39;,indicators, countries,&#39;?startTime=&#39;,start,&#39;&amp;endTime=&#39;,end,sep=&quot;&quot;)</span></span>
<span id="cb47-13"><a href="data-sources.html#cb47-13" aria-hidden="true"></a><span class="co"># </span></span>
<span id="cb47-14"><a href="data-sources.html#cb47-14" aria-hidden="true"></a><span class="co"># #read the data</span></span>
<span id="cb47-15"><a href="data-sources.html#cb47-15" aria-hidden="true"></a><span class="co"># url &lt;- &#39;https://api.uis.unesco.org/sdmx/data/UNESCO,SDG4,2.0/ADMIN.NB.._T._T._T.G2_3+GLAST............?startPeriod=2013&amp;endPeriod=2019&amp;format=csv-sdmx&amp;locale=en&amp;subscription-key=fd406abcbf3d4e318741b8537c92fe43&#39;</span></span>
<span id="cb47-16"><a href="data-sources.html#cb47-16" aria-hidden="true"></a></span>
<span id="cb47-17"><a href="data-sources.html#cb47-17" aria-hidden="true"></a>unesco_df_raw &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file=</span><span class="kw">paste</span>(raw_dir, <span class="st">&#39;4.2_SOAD&#39;</span>,<span class="st">&#39;UIS_SDG_MONITOR&#39;</span>, <span class="st">&#39;SDG_DATA_NATIONAL.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb47-18"><a href="data-sources.html#cb47-18" aria-hidden="true"></a></span>
<span id="cb47-19"><a href="data-sources.html#cb47-19" aria-hidden="true"></a><span class="co">#cleaning of unesco data</span></span>
<span id="cb47-20"><a href="data-sources.html#cb47-20" aria-hidden="true"></a>unesco_df &lt;-<span class="st"> </span>unesco_df_raw <span class="op">%&gt;%</span></span>
<span id="cb47-21"><a href="data-sources.html#cb47-21" aria-hidden="true"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">iso3c=</span>COUNTRY_ID) <span class="op">%&gt;%</span></span>
<span id="cb47-22"><a href="data-sources.html#cb47-22" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">date=</span><span class="kw">as.numeric</span>(YEAR)) <span class="op">%&gt;%</span></span>
<span id="cb47-23"><a href="data-sources.html#cb47-23" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="kw">case_when</span>( <span class="co">#categorize based on whether they are assessment, out of school, or participation data</span></span>
<span id="cb47-24"><a href="data-sources.html#cb47-24" aria-hidden="true"></a>      <span class="kw">grepl</span>(<span class="st">&#39;admi&#39;</span>, INDICATOR_ID) <span class="op">~</span><span class="st"> &quot;NAS&quot;</span>, <span class="co">#Administration of a nationally-representative learning assessment (a) in Grade 2 or 3; (b) at the end of primary education; and (c) at the end of lower secondary education </span></span>
<span id="cb47-25"><a href="data-sources.html#cb47-25" aria-hidden="true"></a>      <span class="co"># grepl(&#39;ROFST&#39;, SDG_IND) ~ &quot;OOS&quot;, # Out-of-school rate by school age and sex</span></span>
<span id="cb47-26"><a href="data-sources.html#cb47-26" aria-hidden="true"></a>      <span class="co"># grepl(&#39;NERA&#39;, SDG_IND) ~ &quot;ORGL&quot; # Participation rate in organized learning (one year before the official primary entry age), by sex</span></span>
<span id="cb47-27"><a href="data-sources.html#cb47-27" aria-hidden="true"></a>    )) <span class="op">%&gt;%</span></span>
<span id="cb47-28"><a href="data-sources.html#cb47-28" aria-hidden="true"></a><span class="st">   </span><span class="kw">filter</span>(type<span class="op">==</span><span class="st">&quot;NAS&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb47-29"><a href="data-sources.html#cb47-29" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">edu_admin_available=</span>(VALUE<span class="op">==</span><span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#get a variable for wehther admin based value exists for indicator</span></span>
<span id="cb47-30"><a href="data-sources.html#cb47-30" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>( iso3c, date, type) <span class="op">%&gt;%</span></span>
<span id="cb47-31"><a href="data-sources.html#cb47-31" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">edu_admin_available=</span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(edu_admin_available))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-32"><a href="data-sources.html#cb47-32" aria-hidden="true"></a><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb47-33"><a href="data-sources.html#cb47-33" aria-hidden="true"></a><span class="st">    </span><span class="kw">pivot_wider</span>(</span>
<span id="cb47-34"><a href="data-sources.html#cb47-34" aria-hidden="true"></a>      <span class="dt">names_from=</span><span class="st">&#39;type&#39;</span>,</span>
<span id="cb47-35"><a href="data-sources.html#cb47-35" aria-hidden="true"></a>      <span class="dt">names_glue=</span><span class="st">&quot;RAW.D4.2.2.EDU.{type}&quot;</span>,</span>
<span id="cb47-36"><a href="data-sources.html#cb47-36" aria-hidden="true"></a>      <span class="dt">values_from=</span><span class="st">&#39;edu_admin_available&#39;</span>,</span>
<span id="cb47-37"><a href="data-sources.html#cb47-37" aria-hidden="true"></a>      <span class="dt">values_fill=</span><span class="ot">NA</span></span>
<span id="cb47-38"><a href="data-sources.html#cb47-38" aria-hidden="true"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb47-39"><a href="data-sources.html#cb47-39" aria-hidden="true"></a><span class="st">    </span><span class="kw">right_join</span>(spi_df_empty) <span class="op">%&gt;%</span></span>
<span id="cb47-40"><a href="data-sources.html#cb47-40" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">starts_with</span>(<span class="st">&#39;RAW.D4.2.2.EDU&#39;</span>),<span class="op">~</span><span class="kw">if_else</span>(<span class="kw">is.na</span>(.),<span class="dv">0</span>,.))) <span class="op">%&gt;%</span></span>
<span id="cb47-41"><a href="data-sources.html#cb47-41" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(iso3c) <span class="op">%&gt;%</span></span>
<span id="cb47-42"><a href="data-sources.html#cb47-42" aria-hidden="true"></a><span class="st">    </span><span class="kw">arrange</span>(<span class="op">-</span>date, iso3c) <span class="op">%&gt;%</span></span>
<span id="cb47-43"><a href="data-sources.html#cb47-43" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">starts_with</span>(<span class="st">&#39;RAW.D4.2.2.EDU&#39;</span>),<span class="op">~</span>zoo<span class="op">::</span><span class="kw">rollmean</span>(.,<span class="dt">k=</span>window,<span class="dt">fill=</span><span class="ot">NA</span>,<span class="dt">align=</span><span class="st">&#39;left&#39;</span>),<span class="dt">.names=</span><span class="st">&quot;{col}.MA5&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#X year rolling average</span></span>
<span id="cb47-44"><a href="data-sources.html#cb47-44" aria-hidden="true"></a><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb47-45"><a href="data-sources.html#cb47-45" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">SPI.D4.2.2.EDU=</span>(RAW.D4.<span class="dv">2</span>.<span class="fl">2.</span>EDU.NAS)) <span class="op">%&gt;%</span></span>
<span id="cb47-46"><a href="data-sources.html#cb47-46" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&#39;iso3c&#39;</span>, <span class="st">&#39;country&#39;</span>, <span class="st">&#39;date&#39;</span>, <span class="st">&#39;RAW.D4.2.2.EDU.NAS&#39;</span>, <span class="st">&#39;SPI.D4.2.2.EDU&#39;</span>)  )</span>
<span id="cb47-47"><a href="data-sources.html#cb47-47" aria-hidden="true"></a></span>
<span id="cb47-48"><a href="data-sources.html#cb47-48" aria-hidden="true"></a><span class="co">#add to spi databases</span></span>
<span id="cb47-49"><a href="data-sources.html#cb47-49" aria-hidden="true"></a>spi_df &lt;-<span class="st"> </span>spi_df <span class="op">%&gt;%</span></span>
<span id="cb47-50"><a href="data-sources.html#cb47-50" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(unesco_df)</span>
<span id="cb47-51"><a href="data-sources.html#cb47-51" aria-hidden="true"></a></span>
<span id="cb47-52"><a href="data-sources.html#cb47-52" aria-hidden="true"></a>unesco_map &lt;-<span class="st"> </span>unesco_df </span>
<span id="cb47-53"><a href="data-sources.html#cb47-53" aria-hidden="true"></a></span>
<span id="cb47-54"><a href="data-sources.html#cb47-54" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;unesco_map&#39;</span>, <span class="st">&#39;SPI.D4.2.2.EDU&#39;</span>, <span class="st">&#39;Education Administrative Data Available According to UIS&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/uis-1.png" width="960" /><img src="01_data_prep_files/figure-html/uis-2.png" width="960" /><img src="01_data_prep_files/figure-html/uis-3.png" width="960" /><img src="01_data_prep_files/figure-html/uis-4.png" width="960" /></p>
</div>
<div id="population-health-admin-data" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Population &amp; Health Admin Data</h3>
<ul>
<li>This indicator is formed using World Bank metadata on whether the Civil Registration and Vital Statistics (CRVS) system is complete in the country.</li>
</ul>
<p>Civil registration is the act of recording and documenting of vital events in a person’s life (including birth, marriage, divorce, adoption, and death and cause of death) and is a fundamental function of national governments. Birth registration establishes an individual’s legal identity at birth. A legal identity, name, nationality, and proof of age, are important human rights. They enable individuals to be included in various government, social and private services, and include the right to vote, etc. Vital statistics are compiled using civil registration information on these vital events. The availability of reliable and up-to-date vital statistics depends on the level of development of civil registration programs. An effective civil registration and vital statistics (CRVS) system is critical for planning and monitoring programs across several sectors.</p>
<p>Data comes from the UNSD Global SDG monitoring database and also the WDI. Scoring is as follows:<br />
1 Points. Both of at least 90% of births registered and at least 75% of deaths registered
0.5 Points. One of at least 90% of births registered or at least 75% of deaths registered
0 Points. Neither</p>
<p>Source: World Bank WDI Metadata.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="data-sources.html#cb48-1" aria-hidden="true"></a><span class="co">#read in data from UNSD database on SDGs</span></span>
<span id="cb48-2"><a href="data-sources.html#cb48-2" aria-hidden="true"></a>df_birth &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file=</span><span class="kw">paste</span>(raw_dir, <span class="st">&#39;4.2_SOAD&#39;</span>, <span class="st">&#39;SG_REG_BRTH90N.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Countries with birth registration data that are at least 90 percent complete (1 = YES; 0 = NO)</span></span>
<span id="cb48-3"><a href="data-sources.html#cb48-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(date<span class="op">&gt;=</span><span class="dv">2015</span> <span class="op">&amp;</span><span class="st"> </span>date<span class="op">&lt;=</span><span class="dv">2019</span>) <span class="op">%&gt;%</span></span>
<span id="cb48-4"><a href="data-sources.html#cb48-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(spi_df_empty) <span class="op">%&gt;%</span></span>
<span id="cb48-5"><a href="data-sources.html#cb48-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">transmute</span>(</span>
<span id="cb48-6"><a href="data-sources.html#cb48-6" aria-hidden="true"></a>    <span class="dt">iso3c=</span>iso3c,</span>
<span id="cb48-7"><a href="data-sources.html#cb48-7" aria-hidden="true"></a>    <span class="dt">country=</span>country,</span>
<span id="cb48-8"><a href="data-sources.html#cb48-8" aria-hidden="true"></a>    <span class="dt">date=</span>date,</span>
<span id="cb48-9"><a href="data-sources.html#cb48-9" aria-hidden="true"></a>    <span class="dt">RAW.D4.2.3.BRTH90=</span>ind_value,</span>
<span id="cb48-10"><a href="data-sources.html#cb48-10" aria-hidden="true"></a>    <span class="dt">SPI.D4.2.3.BRTH90=</span><span class="kw">if_else</span>(ind_value<span class="op">==</span><span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>)</span>
<span id="cb48-11"><a href="data-sources.html#cb48-11" aria-hidden="true"></a>  )</span>
<span id="cb48-12"><a href="data-sources.html#cb48-12" aria-hidden="true"></a></span>
<span id="cb48-13"><a href="data-sources.html#cb48-13" aria-hidden="true"></a>df_death &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file=</span><span class="kw">paste</span>(raw_dir, <span class="st">&#39;4.2_SOAD&#39;</span>, <span class="st">&#39;SG_REG_DETH75N.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Countries with death registration data that are at least 75 percent complete (1 = YES; 0 = NO)</span></span>
<span id="cb48-14"><a href="data-sources.html#cb48-14" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(date<span class="op">&gt;=</span><span class="dv">2015</span><span class="op">&amp;</span><span class="st"> </span>date<span class="op">&lt;=</span><span class="dv">2019</span>) <span class="op">%&gt;%</span></span>
<span id="cb48-15"><a href="data-sources.html#cb48-15" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(spi_df_empty) <span class="op">%&gt;%</span></span>
<span id="cb48-16"><a href="data-sources.html#cb48-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">transmute</span>(</span>
<span id="cb48-17"><a href="data-sources.html#cb48-17" aria-hidden="true"></a>    <span class="dt">iso3c=</span>iso3c,</span>
<span id="cb48-18"><a href="data-sources.html#cb48-18" aria-hidden="true"></a>    <span class="dt">country=</span>country,</span>
<span id="cb48-19"><a href="data-sources.html#cb48-19" aria-hidden="true"></a>    <span class="dt">date=</span>date,</span>
<span id="cb48-20"><a href="data-sources.html#cb48-20" aria-hidden="true"></a>    <span class="dt">RAW.D4.2.3.DETH75=</span>ind_value,</span>
<span id="cb48-21"><a href="data-sources.html#cb48-21" aria-hidden="true"></a>    <span class="dt">SPI.D4.2.3.DETH75=</span><span class="kw">if_else</span>(ind_value<span class="op">==</span><span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">0</span>)</span>
<span id="cb48-22"><a href="data-sources.html#cb48-22" aria-hidden="true"></a>  )</span>
<span id="cb48-23"><a href="data-sources.html#cb48-23" aria-hidden="true"></a></span>
<span id="cb48-24"><a href="data-sources.html#cb48-24" aria-hidden="true"></a><span class="co">#supplement with wdi data</span></span>
<span id="cb48-25"><a href="data-sources.html#cb48-25" aria-hidden="true"></a>crvs_wdi &lt;-<span class="st"> </span>WDI_metadata <span class="op">%&gt;%</span></span>
<span id="cb48-26"><a href="data-sources.html#cb48-26" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(Country.Code, date, Vital.registration.complete) <span class="op">%&gt;%</span></span>
<span id="cb48-27"><a href="data-sources.html#cb48-27" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iso3c=</span>Country.Code,</span>
<span id="cb48-28"><a href="data-sources.html#cb48-28" aria-hidden="true"></a>         <span class="dt">SPI.D4.2.3.WDI=</span><span class="kw">if_else</span>(<span class="kw">grepl</span>(<span class="st">&#39;Yes&#39;</span>, Vital.registration.complete),<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb48-29"><a href="data-sources.html#cb48-29" aria-hidden="true"></a>         <span class="dt">RAW.D4.2.3.CRVS.WDI=</span>Vital.registration.complete) <span class="op">%&gt;%</span></span>
<span id="cb48-30"><a href="data-sources.html#cb48-30" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Country.Code, <span class="op">-</span>Vital.registration.complete)</span>
<span id="cb48-31"><a href="data-sources.html#cb48-31" aria-hidden="true"></a></span>
<span id="cb48-32"><a href="data-sources.html#cb48-32" aria-hidden="true"></a>crvs_df &lt;-<span class="st"> </span>df_birth <span class="op">%&gt;%</span></span>
<span id="cb48-33"><a href="data-sources.html#cb48-33" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(df_death) <span class="op">%&gt;%</span></span>
<span id="cb48-34"><a href="data-sources.html#cb48-34" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(crvs_wdi) <span class="op">%&gt;%</span></span>
<span id="cb48-35"><a href="data-sources.html#cb48-35" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb48-36"><a href="data-sources.html#cb48-36" aria-hidden="true"></a>         <span class="dt">SPI.D4.2.3.CRVS=</span>SPI.D4.<span class="dv">2</span>.<span class="fl">3.</span>DETH75<span class="op">+</span>SPI.D4.<span class="dv">2</span>.<span class="fl">3.</span>BRTH90,</span>
<span id="cb48-37"><a href="data-sources.html#cb48-37" aria-hidden="true"></a>         <span class="dt">SPI.D4.2.3.CRVS=</span><span class="kw">if_else</span>(<span class="kw">is.na</span>(SPI.D4.<span class="dv">2</span>.<span class="fl">3.</span>CRVS),SPI.D4.<span class="dv">2</span>.<span class="fl">3.</span>WDI,SPI.D4.<span class="dv">2</span>.<span class="fl">3.</span>CRVS)) <span class="op">%&gt;%</span></span>
<span id="cb48-38"><a href="data-sources.html#cb48-38" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>SPI.D4.<span class="dv">2</span>.<span class="fl">3.</span>WDI) <span class="op">%&gt;%</span></span>
<span id="cb48-39"><a href="data-sources.html#cb48-39" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span></span>
<span id="cb48-40"><a href="data-sources.html#cb48-40" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), na.locf, <span class="dt">na.rm=</span><span class="ot">FALSE</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#use carry forward to most recent value</span></span>
<span id="cb48-41"><a href="data-sources.html#cb48-41" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">starts_with</span>(<span class="st">&quot;SPI&quot;</span>), <span class="op">~</span><span class="kw">if_else</span>(<span class="kw">is.na</span>(.),<span class="dv">0</span>,.))) <span class="op">%&gt;%</span></span>
<span id="cb48-42"><a href="data-sources.html#cb48-42" aria-hidden="true"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb48-43"><a href="data-sources.html#cb48-43" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="kw">c</span>( <span class="st">&#39;country&#39;</span>, <span class="st">&#39;date&#39;</span>,<span class="st">&#39;RAW.D4.2.3.BRTH90&#39;</span>, <span class="st">&#39;RAW.D4.2.3.DETH75&#39;</span>, <span class="st">&#39;RAW.D4.2.3.CRVS.WDI&#39;</span>, <span class="st">&#39;SPI.D4.2.3.CRVS&#39;</span>)  ) </span>
<span id="cb48-44"><a href="data-sources.html#cb48-44" aria-hidden="true"></a></span>
<span id="cb48-45"><a href="data-sources.html#cb48-45" aria-hidden="true"></a></span>
<span id="cb48-46"><a href="data-sources.html#cb48-46" aria-hidden="true"></a></span>
<span id="cb48-47"><a href="data-sources.html#cb48-47" aria-hidden="true"></a></span>
<span id="cb48-48"><a href="data-sources.html#cb48-48" aria-hidden="true"></a><span class="co">#add to spi databases</span></span>
<span id="cb48-49"><a href="data-sources.html#cb48-49" aria-hidden="true"></a>spi_df &lt;-<span class="st"> </span>spi_df <span class="op">%&gt;%</span></span>
<span id="cb48-50"><a href="data-sources.html#cb48-50" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(crvs_df)</span>
<span id="cb48-51"><a href="data-sources.html#cb48-51" aria-hidden="true"></a></span>
<span id="cb48-52"><a href="data-sources.html#cb48-52" aria-hidden="true"></a></span>
<span id="cb48-53"><a href="data-sources.html#cb48-53" aria-hidden="true"></a>crvs_map &lt;-<span class="st"> </span>crvs_df </span>
<span id="cb48-54"><a href="data-sources.html#cb48-54" aria-hidden="true"></a></span>
<span id="cb48-55"><a href="data-sources.html#cb48-55" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;crvs_map&#39;</span>, <span class="st">&#39;SPI.D4.2.3.CRVS&#39;</span>, <span class="st">&#39;Complete Civil Registration &amp; Vital Statistics Data Available According to WDI&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/crvs-1.png" width="960" /><img src="01_data_prep_files/figure-html/crvs-2.png" width="960" /><img src="01_data_prep_files/figure-html/crvs-3.png" width="960" /><img src="01_data_prep_files/figure-html/crvs-4.png" width="960" /></p>
</div>
<div id="labor-admin-data" class="section level3" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Labor Admin Data</h3>
<ul>
<li><p>ILO shared database containing all administrative data sources used to produce ILO statistics (ILOSTAT)</p>
<ul>
<li>May not be comprehensive of all administrative datasets available in a country<br />
</li>
<li>But gives some indication of whether labor statistics produced using Admin data</li>
</ul></li>
<li><p>Database contains the following admin sources:</p>
<ul>
<li>Insurance records<br />
</li>
<li>Labour inspectorate records<br />
</li>
<li>Records of employers’ organizations<br />
</li>
<li>Employment office records</li>
<li>Records of workers’ organizations</li>
<li>Other administrative records and related sources</li>
</ul></li>
<li><p>Database extends from 2010 to 2019 and covers 177 countries.</p></li>
</ul>
<p>To produce a score, we calculate the percentage of these six admin sources above that are available for a country in a given year. In order to smooth out gaps in reporting, we take a moving 5 year average of the score.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="data-sources.html#cb49-1" aria-hidden="true"></a><span class="co">#read data</span></span>
<span id="cb49-2"><a href="data-sources.html#cb49-2" aria-hidden="true"></a>ilo_df_raw &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">paste</span>(raw_dir, <span class="st">&#39;4.2_SOAD&#39;</span>,<span class="st">&#39;ILOSTAT_sources.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb49-3"><a href="data-sources.html#cb49-3" aria-hidden="true"></a></span>
<span id="cb49-4"><a href="data-sources.html#cb49-4" aria-hidden="true"></a><span class="co">#cleaning of aspire data</span></span>
<span id="cb49-5"><a href="data-sources.html#cb49-5" aria-hidden="true"></a>ilo_df &lt;-<span class="st"> </span>ilo_df_raw <span class="op">%&gt;%</span></span>
<span id="cb49-6"><a href="data-sources.html#cb49-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&#39;legislation&#39;</span>,Source)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># filter out labor legislation, which is included but not reflective of needs.</span></span>
<span id="cb49-7"><a href="data-sources.html#cb49-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="kw">case_when</span>( <span class="co">#categorize based on whether they are assessment, out of school, or participation data</span></span>
<span id="cb49-8"><a href="data-sources.html#cb49-8" aria-hidden="true"></a>      (Source.type<span class="op">==</span><span class="st">&quot;Insurance records&quot;</span> ) <span class="op">~</span><span class="st"> &quot;INSUR&quot;</span>, <span class="co">#Insurance records </span></span>
<span id="cb49-9"><a href="data-sources.html#cb49-9" aria-hidden="true"></a>      (Source.type<span class="op">==</span><span class="st">&quot;Labour inspectorate records&quot;</span> ) <span class="op">~</span><span class="st"> &quot;INSP&quot;</span>, <span class="co"># Labour inspectorate records  </span></span>
<span id="cb49-10"><a href="data-sources.html#cb49-10" aria-hidden="true"></a>      (Source.type<span class="op">==</span><span class="st">&quot;Records of employers&#39; organizations&quot;</span> ) <span class="op">~</span><span class="st"> &quot;EMPORG&quot;</span>, <span class="co"># Records of employers&#39; organizations</span></span>
<span id="cb49-11"><a href="data-sources.html#cb49-11" aria-hidden="true"></a>      (Source.type<span class="op">==</span><span class="st">&quot;Employment office records&quot;</span> ) <span class="op">~</span><span class="st"> &quot;EMPOFF&quot;</span>, <span class="co"># Employment office records</span></span>
<span id="cb49-12"><a href="data-sources.html#cb49-12" aria-hidden="true"></a>      (Source.type<span class="op">==</span><span class="st">&quot;Records of workers&#39; organizations&quot;</span>  ) <span class="op">~</span><span class="st"> &quot;WRKORG&quot;</span>, <span class="co"># Records of workers&#39; organizations</span></span>
<span id="cb49-13"><a href="data-sources.html#cb49-13" aria-hidden="true"></a>      (Source.type<span class="op">==</span><span class="st">&quot;Other administrative records and related sources&quot;</span> ) <span class="op">~</span><span class="st"> &quot;OTHER&quot;</span> <span class="co"># Other administrative records and related sources</span></span>
<span id="cb49-14"><a href="data-sources.html#cb49-14" aria-hidden="true"></a>                        ),</span>
<span id="cb49-15"><a href="data-sources.html#cb49-15" aria-hidden="true"></a>      <span class="dt">admin_available=</span><span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb49-16"><a href="data-sources.html#cb49-16" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(iso3c, date, type,Source ) <span class="op">%&gt;%</span></span>
<span id="cb49-17"><a href="data-sources.html#cb49-17" aria-hidden="true"></a><span class="st">      </span><span class="kw">pivot_wider</span>(</span>
<span id="cb49-18"><a href="data-sources.html#cb49-18" aria-hidden="true"></a>      <span class="dt">names_from=</span><span class="st">&#39;type&#39;</span>,</span>
<span id="cb49-19"><a href="data-sources.html#cb49-19" aria-hidden="true"></a>      <span class="dt">names_glue=</span><span class="st">&quot;RAW.D4.2.4.LBR.{type}&quot;</span>,</span>
<span id="cb49-20"><a href="data-sources.html#cb49-20" aria-hidden="true"></a>      <span class="dt">values_from=</span><span class="st">&#39;Source&#39;</span>,</span>
<span id="cb49-21"><a href="data-sources.html#cb49-21" aria-hidden="true"></a>      <span class="dt">values_fill=</span><span class="ot">NULL</span></span>
<span id="cb49-22"><a href="data-sources.html#cb49-22" aria-hidden="true"></a>    ) </span>
<span id="cb49-23"><a href="data-sources.html#cb49-23" aria-hidden="true"></a></span>
<span id="cb49-24"><a href="data-sources.html#cb49-24" aria-hidden="true"></a></span>
<span id="cb49-25"><a href="data-sources.html#cb49-25" aria-hidden="true"></a><span class="co">#apply carryforward to fill in missing values</span></span>
<span id="cb49-26"><a href="data-sources.html#cb49-26" aria-hidden="true"></a>ilo_df &lt;-<span class="st"> </span>ilo_df <span class="op">%&gt;%</span></span>
<span id="cb49-27"><a href="data-sources.html#cb49-27" aria-hidden="true"></a><span class="st">  </span><span class="kw">right_join</span>(spi_df_empty) <span class="op">%&gt;%</span></span>
<span id="cb49-28"><a href="data-sources.html#cb49-28" aria-hidden="true"></a><span class="st">  </span><span class="kw">arrange</span>(iso3c, date) <span class="op">%&gt;%</span></span>
<span id="cb49-29"><a href="data-sources.html#cb49-29" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(iso3c) <span class="op">%&gt;%</span></span>
<span id="cb49-30"><a href="data-sources.html#cb49-30" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">starts_with</span>(<span class="st">&#39;RAW.D4.2.4.LBR&#39;</span>),</span>
<span id="cb49-31"><a href="data-sources.html#cb49-31" aria-hidden="true"></a>                <span class="op">~</span><span class="kw">if_else</span>(.<span class="op">!=</span><span class="st">&#39;NULL&#39;</span>,<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb49-32"><a href="data-sources.html#cb49-32" aria-hidden="true"></a>                <span class="dt">.names=</span><span class="st">&quot;{col}_available&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb49-33"><a href="data-sources.html#cb49-33" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ILO.Source.type.filled=</span>(RAW.D4.<span class="dv">2</span>.<span class="fl">4.</span>LBR.OTHER_available <span class="op">+</span></span>
<span id="cb49-34"><a href="data-sources.html#cb49-34" aria-hidden="true"></a><span class="st">                                </span>RAW.D4.<span class="dv">2</span>.<span class="fl">4.</span>LBR.INSUR_available <span class="op">+</span></span>
<span id="cb49-35"><a href="data-sources.html#cb49-35" aria-hidden="true"></a><span class="st">                                </span>RAW.D4.<span class="dv">2</span>.<span class="fl">4.</span>LBR.EMPOFF_available<span class="op">+</span></span>
<span id="cb49-36"><a href="data-sources.html#cb49-36" aria-hidden="true"></a><span class="st">                                </span>RAW.D4.<span class="dv">2</span>.<span class="fl">4.</span>LBR.WRKORG_available<span class="op">+</span></span>
<span id="cb49-37"><a href="data-sources.html#cb49-37" aria-hidden="true"></a><span class="st">                                </span>RAW.D4.<span class="dv">2</span>.<span class="fl">4.</span>LBR.INSP_available  <span class="op">+</span></span>
<span id="cb49-38"><a href="data-sources.html#cb49-38" aria-hidden="true"></a><span class="st">                                </span>RAW.D4.<span class="dv">2</span>.<span class="fl">4.</span>LBR.EMPORG_available)<span class="op">/</span><span class="dv">6</span>) <span class="op">%&gt;%</span></span>
<span id="cb49-39"><a href="data-sources.html#cb49-39" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(iso3c) <span class="op">%&gt;%</span></span>
<span id="cb49-40"><a href="data-sources.html#cb49-40" aria-hidden="true"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>date, iso3c) <span class="op">%&gt;%</span></span>
<span id="cb49-41"><a href="data-sources.html#cb49-41" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">starts_with</span>(<span class="st">&#39;ILO.Source.type.filled&#39;</span>),<span class="op">~</span>zoo<span class="op">::</span><span class="kw">rollmean</span>(.,<span class="dt">k=</span>window,<span class="dt">fill=</span><span class="ot">NA</span>,<span class="dt">align=</span><span class="st">&#39;left&#39;</span>),<span class="dt">.names=</span><span class="st">&quot;{col}.MA5&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#X year rolling average</span></span>
<span id="cb49-42"><a href="data-sources.html#cb49-42" aria-hidden="true"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb49-43"><a href="data-sources.html#cb49-43" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">SPI.D4.2.4.LBR=</span><span class="kw">if_else</span>(<span class="kw">is.na</span>(ILO.Source.type.filled.MA5),<span class="dv">0</span>, ILO.Source.type.filled.MA5)) <span class="op">%&gt;%</span></span>
<span id="cb49-44"><a href="data-sources.html#cb49-44" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&#39;iso3c&#39;</span>, <span class="st">&#39;country&#39;</span>, <span class="st">&#39;date&#39;</span>, <span class="st">&#39;SPI.D4.2.4.LBR&#39;</span>), <span class="kw">starts_with</span>(<span class="st">&#39;RAW.D4.2.4.LBR&#39;</span>)  ) <span class="op">%&gt;%</span></span>
<span id="cb49-45"><a href="data-sources.html#cb49-45" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">ends_with</span>(<span class="st">&#39;available&#39;</span>))</span>
<span id="cb49-46"><a href="data-sources.html#cb49-46" aria-hidden="true"></a></span>
<span id="cb49-47"><a href="data-sources.html#cb49-47" aria-hidden="true"></a><span class="co">#add to spi databases</span></span>
<span id="cb49-48"><a href="data-sources.html#cb49-48" aria-hidden="true"></a>spi_df &lt;-<span class="st"> </span>spi_df <span class="op">%&gt;%</span></span>
<span id="cb49-49"><a href="data-sources.html#cb49-49" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(ilo_df)  </span>
<span id="cb49-50"><a href="data-sources.html#cb49-50" aria-hidden="true"></a></span>
<span id="cb49-51"><a href="data-sources.html#cb49-51" aria-hidden="true"></a></span>
<span id="cb49-52"><a href="data-sources.html#cb49-52" aria-hidden="true"></a>ilo_map &lt;-<span class="st"> </span>ilo_df </span>
<span id="cb49-53"><a href="data-sources.html#cb49-53" aria-hidden="true"></a></span>
<span id="cb49-54"><a href="data-sources.html#cb49-54" aria-hidden="true"></a><span class="kw">spi_mapper</span>(<span class="st">&#39;ilo_map&#39;</span>, <span class="st">&#39;SPI.D4.2.4.LBR&#39;</span>, <span class="st">&#39;Labor Administrative Data Available According to ILO&#39;</span> )</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/ilo-1.png" width="960" /><img src="01_data_prep_files/figure-html/ilo-2.png" width="960" /><img src="01_data_prep_files/figure-html/ilo-3.png" width="960" /><img src="01_data_prep_files/figure-html/ilo-4.png" width="960" /></p>
</div>
</div>
<div id="indicator-4.3-geospatial-data" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Indicator 4.3: geospatial data</h2>
<p>New indicator based on references to geospatial data in metadata relating to content on NSO website</p>
<div id="source-1" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Source</h3>
<p>Our source for this indicator is Open Data Watch. From Open Data watch:</p>
<blockquote>
<p>The Open Data Inventory (ODIN) assesses the coverage and openness of official statistics to help identify gaps, promote open data policies, improve access, and encourage dialogue
between national statistical offices (NSOs) and data users. ODIN 2018/19 includes 178 countries, including most all OECD countries. Two-year comparisons are for all countries with
two years of data between 2015-2017. Scores can be compared across topics and countries.</p>
</blockquote>
<p>We use their indicator on whether indicators are available at the first or second administrative level. To identify the first administrative levels, ODIN largely draws on the ISO 3166-2 standard. In many countries, first administrative levels refer to governorates, regions, or province. No official list exists for the second administrative level classifications. If geographical disaggregation exists that does not qualify as first administrative level, assume that the data are disaggregated to the second administrative level as long as the classification appears to be a further divisions of the first administrative level.</p>
<p>Scoring for the ODIN indicators for geospatial information is below:</p>
<ul>
<li>1 point if all published data in a data category are available at first/second administrative level.<br />
</li>
<li>0.5 points if some published data in a data category are available at first/second administrative level.<br />
</li>
<li>0 points if no data are available at this level</li>
</ul>
<p>There are 21 data categories.</p>
<p>Social Statistics<br />
1. Population and Vital Statistics<br />
2. Education Facilities<br />
3. Education Outcomes<br />
4. Health Facilities<br />
5. Health Outcomes<br />
6. Reproductive Health<br />
7. Gender Statistics<br />
8. Crime and Justice Statistics<br />
9. Poverty Statistics</p>
<p>Economic Statistics<br />
10. National Accounts<br />
11. Labor Statistics<br />
12. Price Indexes<br />
13. Government Finance<br />
14. Money and Banking<br />
15. International Trade<br />
16. Balance of Payments</p>
<p>Environmental Statistics<br />
17. Land Use<br />
18. Resource Use<br />
19. Energy Use<br />
20. Pollution<br />
21. Built Environment</p>
<p>For the first administrative unit: Money &amp; Banking, International Trade, and Balance of Payments are not scored for this element. For various indicators, lenient interpretations are used for first administrative divisions.</p>
<p>For the second administrative unit: Money &amp; Banking, International Trade, Balance of Payments, National Accounts, Government Finance ,Pollution, Energy Use, Price Indexes, and Resource Use are not scored for this element. For various indicators within categories, second administrative level data is not required as well.</p>
<p>In the scores we present below, we show a score between 0 and 1 with a maximum score of 1, which would mean the country has geo data in full for 100% of elements. A score of 0 indicates no data at all for any elements.</p>
<p>More details on the geographic disaggregation considerations can be found in their technical manual:</p>
<p><a href="https://docs.google.com/document/d/1ubPL1l_3im9bjlCVZ6W2ICAy6UAiXl1hGeA1aXImkxI/edit" class="uri">https://docs.google.com/document/d/1ubPL1l_3im9bjlCVZ6W2ICAy6UAiXl1hGeA1aXImkxI/edit</a></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="data-sources.html#cb50-1" aria-hidden="true"></a>  <span class="co">#read in ODIN data</span></span>
<span id="cb50-2"><a href="data-sources.html#cb50-2" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2015</span><span class="op">:</span><span class="dv">2018</span>) {</span>
<span id="cb50-3"><a href="data-sources.html#cb50-3" aria-hidden="true"></a>   temp &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">paste</span>(raw_dir, <span class="st">&#39;/2.2_DSOA/&#39;</span>,<span class="st">&#39;ODIN_&#39;</span>,i,<span class="st">&#39;.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))  <span class="op">%&gt;%</span></span>
<span id="cb50-4"><a href="data-sources.html#cb50-4" aria-hidden="true"></a><span class="st">        </span><span class="kw">as_tibble</span>(<span class="dt">.name_repair =</span> <span class="st">&#39;universal&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb50-5"><a href="data-sources.html#cb50-5" aria-hidden="true"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">date=</span>i) <span class="op">%&gt;%</span></span>
<span id="cb50-6"><a href="data-sources.html#cb50-6" aria-hidden="true"></a><span class="st">        </span><span class="kw">filter</span>(Data.categories<span class="op">==</span><span class="st">&#39;All Categories&#39;</span>)</span>
<span id="cb50-7"><a href="data-sources.html#cb50-7" aria-hidden="true"></a></span>
<span id="cb50-8"><a href="data-sources.html#cb50-8" aria-hidden="true"></a>    <span class="kw">assign</span>(<span class="kw">paste</span>(<span class="st">&#39;geo_df&#39;</span>,i,<span class="dt">sep=</span><span class="st">&quot;_&quot;</span>), temp)</span>
<span id="cb50-9"><a href="data-sources.html#cb50-9" aria-hidden="true"></a>  }</span>
<span id="cb50-10"><a href="data-sources.html#cb50-10" aria-hidden="true"></a></span>
<span id="cb50-11"><a href="data-sources.html#cb50-11" aria-hidden="true"></a><span class="co">#bind different years together</span></span>
<span id="cb50-12"><a href="data-sources.html#cb50-12" aria-hidden="true"></a>geo_df &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(geo_df_<span class="dv">2015</span>, geo_df_<span class="dv">2016</span>, geo_df_<span class="dv">2017</span>, geo_df_<span class="dv">2018</span>)</span>
<span id="cb50-13"><a href="data-sources.html#cb50-13" aria-hidden="true"></a></span>
<span id="cb50-14"><a href="data-sources.html#cb50-14" aria-hidden="true"></a></span>
<span id="cb50-15"><a href="data-sources.html#cb50-15" aria-hidden="true"></a><span class="co">#create geo scores</span></span>
<span id="cb50-16"><a href="data-sources.html#cb50-16" aria-hidden="true"></a>geo_df &lt;-<span class="st"> </span>geo_df <span class="op">%&gt;%</span></span>
<span id="cb50-17"><a href="data-sources.html#cb50-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(Country.Code, date, First.administrative.level, Second.administrative.level) <span class="op">%&gt;%</span></span>
<span id="cb50-18"><a href="data-sources.html#cb50-18" aria-hidden="true"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">iso3c=</span>Country.Code) <span class="op">%&gt;%</span></span>
<span id="cb50-19"><a href="data-sources.html#cb50-19" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>( iso3c) <span class="op">%&gt;%</span></span>
<span id="cb50-20"><a href="data-sources.html#cb50-20" aria-hidden="true"></a><span class="st">    </span><span class="kw">right_join</span>(country_metadata) <span class="op">%&gt;%</span></span>
<span id="cb50-21"><a href="data-sources.html#cb50-21" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">D4.3.GEO.first.admin.level=</span><span class="kw">if_else</span>(<span class="kw">is.na</span>(First.administrative.level), <span class="dv">0</span>, First.administrative.level),</span>
<span id="cb50-22"><a href="data-sources.html#cb50-22" aria-hidden="true"></a>           <span class="dt">D4.3.GEO.second.admin.level=</span><span class="kw">if_else</span>(<span class="kw">is.na</span>(Second.administrative.level), <span class="dv">0</span>, Second.administrative.level))    </span>
<span id="cb50-23"><a href="data-sources.html#cb50-23" aria-hidden="true"></a>  </span>
<span id="cb50-24"><a href="data-sources.html#cb50-24" aria-hidden="true"></a></span>
<span id="cb50-25"><a href="data-sources.html#cb50-25" aria-hidden="true"></a><span class="co">#do some quick renaming and formatting</span></span>
<span id="cb50-26"><a href="data-sources.html#cb50-26" aria-hidden="true"></a>geo_df_temp1 &lt;-<span class="st"> </span>geo_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb50-27"><a href="data-sources.html#cb50-27" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename_with</span>(<span class="op">~</span><span class="kw">paste</span>(<span class="st">&#39;RAW&#39;</span>,., <span class="dt">sep=</span><span class="st">&quot;.&quot;</span>), <span class="dt">.cols=</span><span class="kw">c</span>(<span class="st">&#39;D4.3.GEO.first.admin.level&#39;</span>, <span class="st">&#39;D4.3.GEO.second.admin.level&#39;</span>) ) </span>
<span id="cb50-28"><a href="data-sources.html#cb50-28" aria-hidden="true"></a></span>
<span id="cb50-29"><a href="data-sources.html#cb50-29" aria-hidden="true"></a></span>
<span id="cb50-30"><a href="data-sources.html#cb50-30" aria-hidden="true"></a>geo_df_temp2 &lt;-<span class="st"> </span>geo_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb50-31"><a href="data-sources.html#cb50-31" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">c</span>(<span class="st">&#39;D4.3.GEO.first.admin.level&#39;</span>, <span class="st">&#39;D4.3.GEO.second.admin.level&#39;</span>), <span class="op">~</span>.<span class="op">/</span><span class="dv">100</span>)) <span class="op">%&gt;%</span></span>
<span id="cb50-32"><a href="data-sources.html#cb50-32" aria-hidden="true"></a><span class="st">  </span><span class="kw">rename_with</span>(<span class="op">~</span><span class="kw">paste</span>(<span class="st">&#39;SPI&#39;</span>,., <span class="dt">sep=</span><span class="st">&quot;.&quot;</span>), <span class="dt">.cols=</span><span class="kw">c</span>(<span class="st">&#39;D4.3.GEO.first.admin.level&#39;</span>, <span class="st">&#39;D4.3.GEO.second.admin.level&#39;</span>) ) </span>
<span id="cb50-33"><a href="data-sources.html#cb50-33" aria-hidden="true"></a></span>
<span id="cb50-34"><a href="data-sources.html#cb50-34" aria-hidden="true"></a>geo_df &lt;-<span class="st"> </span>geo_df_temp1 <span class="op">%&gt;%</span></span>
<span id="cb50-35"><a href="data-sources.html#cb50-35" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(geo_df_temp2)</span>
<span id="cb50-36"><a href="data-sources.html#cb50-36" aria-hidden="true"></a></span>
<span id="cb50-37"><a href="data-sources.html#cb50-37" aria-hidden="true"></a><span class="co">#add to spi df</span></span>
<span id="cb50-38"><a href="data-sources.html#cb50-38" aria-hidden="true"></a>spi_df &lt;-<span class="st"> </span>spi_df <span class="op">%&gt;%</span></span>
<span id="cb50-39"><a href="data-sources.html#cb50-39" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(geo_df)</span></code></pre></div>
<p><img src="01_data_prep_files/figure-html/geo_plots-1.png" width="960" /><img src="01_data_prep_files/figure-html/geo_plots-2.png" width="960" /><img src="01_data_prep_files/figure-html/geo_plots-3.png" width="960" /><img src="01_data_prep_files/figure-html/geo_plots-4.png" width="960" /><img src="01_data_prep_files/figure-html/geo_plots-5.png" width="960" /><img src="01_data_prep_files/figure-html/geo_plots-6.png" width="960" /></p>
</div>
</div>
<div id="indicator-4.4-privatecitizen-generated-data" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Indicator 4.4: private/citizen generated data</h2>
<p>New indicator based on references to private/citizen generated data in metadata relating to content on NSO website.</p>
<div id="covid-mobility-data-availability" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Covid Mobility Data Availability</h3>
<p>We have seen an increased use of private/citizen generated data during the COVID-19 pandemic. One way in which it has been used is for tracking mobility of citizens to understand the social distancing measures citizens are taking. As a measure of private/citizen generated data we make use of Apple and Google Mobility tracking data made publicly available during the pandemic.</p>
<p>Source:</p>
<p>Google LLC “Google COVID-19 Community Mobility Reports”.
<a href="https://www.google.com/covid19/mobility/" class="uri">https://www.google.com/covid19/mobility/</a> Accessed: 2020-07-23.</p>
<p>Apple “Mobility Trends Reports”.
<a href="https://www.apple.com/covid19/mobility/" class="uri">https://www.apple.com/covid19/mobility/</a> Accessed: 2020-07-23.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="scoring.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-infrastructure.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
